---
tags:
  - 旋转体的体积
title: 原创微积分题：圆锥、抛物线旋转体等几何体放入水箱，水位会变成多少
ctime: '1760803120964'
ctime_f: '2025-10-18 23:58:40'
mtime: '1760881481742'
mtime_f: '2025-10-19 21:44:41'
---
Hans在小学五年级的时候突然考了张颇有难度的奥数卷子。笔者当时完全没学过奥数，但凭借自己的推理能力把每道题的结论都推出来了，那种踮踮脚成功够到的爽感我直到现在都还记忆犹新。其中有道题就是，把一个圆柱放进一个足够高的长方体水箱，问水位变为多少。这题不能直接算，要讨论是否完全浸没。如果完全浸没，直接

$$
SH = V_{water} + V_{cylinder}
$$

就做完了。否则，把水看成由一个固定面积的图形堆叠起来的就行。

但我们学完高等数学这门课后，就能做这道5.1年级的题目了：设水箱底面积为S，初始水位高度为c，假设水不会溢出。现在放入一个底面半径为r，高度为h的圆锥，设水位高度变为H。于是H是关于h的单增函数。请写代码画出它们的关系图、

设高度x对应的截面与圆心的距离为 $f(x)$ ，则有旋转体的体积公式

$$
V = \int_{0}^h \pi f^2(x) dx
$$

作为练手，我们不妨先推导圆锥的体积公式。可旋转得到圆锥的曲线是一条过 $(0,r)$ 和 $(H,0)$ 的直线，所以圆锥的体积为

$$
V = \int_{0}^h \pi (r-\frac{r}{h}x)^2 dx = \pi r^2 \int_{0}^h (\frac{x^2}{h^2}-\frac{2x}{h}+1) dx = \pi r^2 (\frac{x^3}{3h^2}-\frac{x^2}{h}+x) \bigg|_{0}^h = \frac{\pi r^2h}{3}
$$

有了体积公式，h较小，圆锥被完全浸没的情况也就解决了

$$
SH = Sc + \frac{\pi r^2h}{3} \Rightarrow H = c + \frac{\pi r^2h}{3S}
$$

我们令这个式子的 $H = h$ 就解得临界高度

$$
H = \frac{Sc}{S-\frac{\pi r^2}{3}}
$$

接下来看圆锥未被完全浸没的情况。把H代入上述积分式子，我们有

$$
S(H-c) = \pi r^2 (\frac{H^3}{3h}-\frac{H^2}{h}+H)
$$

这里的H和h无法轻易分离，所以我们只简单化简一下

$$
\frac{\pi r^2}{3h^2}H^3 - \frac{\pi r^2}{h}H^2 + (\pi r^2-S)H + Sc = 0
$$

我们遍历每一个h，则这是一个关于H的三次方程。用sympy来解这个方程
