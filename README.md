[TOC]

# é€šè¿‡ä¸ºå‰ç«¯é¡¹ç›®æ¥å…¥GeoGebraï¼Œåˆæ­¥ç ”ç©¶AIæ—¶ä»£æ•°å­¦æ•™æ¡ˆçš„ç”Ÿæˆæ–¹æ¡ˆï¼ˆå·²éƒ¨ç½²GitHub Pagesï¼‰

## å¼•è¨€

æˆ‘å¶ç„¶åˆ·åˆ°äº†[è¿™ä¸ªè§†é¢‘](https://www.bilibili.com/video/BV1UeK8zAErv)ï¼Œå®ƒç»™æˆ‘ä¸€ç§å¼ºçƒˆçš„æ„Ÿè§‰ï¼Œå°±æ˜¯ä¸‹ä¸€ä»£çš„æ¯ä¸€ä¸ªå­¦ç”Ÿï¼Œåªè¦ä¼šè¯´HTMLã€Tailwind CSSã€JavaScriptè¿™å°‘æ•°å‡ ä¸ªè¯ï¼Œå°±èƒ½è½»æ¾ç”Ÿæˆå±äºè‡ªå·±çš„äº’åŠ¨æ€§æå¼ºçš„æ•°å­¦è¯¾ä»¶ã€‚æˆ‘æ„Ÿå—åˆ°äº†æå…¶å¼ºçƒˆçš„ç„¦è™‘ï¼Œä¸‹ä¸€ä»£çš„å­¦ç”Ÿï¼Œè‚¯å®šèƒ½æ¯”æˆ‘ä»¬è¿™ä¸€ä»£äººæ›´å¿«åœ°æ›´æ–°è¿­ä»£è‡ªå·±çš„çŸ¥è¯†ä½“ç³»ã€‚æˆ‘ä»¬ä¸€å¤©æ‰èƒ½å­¦ä¼šçš„ä¸œè¥¿ï¼Œä»–ä»¬å¯èƒ½ä¸€å°æ—¶å°±èƒ½å­¦ä¼šã€‚ä»¥åä»–ä»¬çš„å·¥ä½œèƒ½åŠ›è‚¯å®šèƒ½è½»æ¾ç¢¾å‹æˆ‘ä»¬ã€‚æ‰€ä»¥è‡³å°‘åœ¨LLMå°šæœªååˆ†æˆç†Ÿçš„2025ï¼Œæˆ‘æƒ³èµ°åœ¨ä¸‹ä¸€ä»£äººçš„å‰é¢ï¼Œå“ªæ€•åªæ˜¯ç”¨è¡ŒåŠ¨éª—éª—è‡ªå·±ï¼Œæœ‰èƒ½åŠ›æ¯”ä¸‹ä¸€ä»£äººæ›´å¿«é©¾é©­LLMâ€¦â€¦

å’³å’³ï¼Œå…ˆä¸æŠ’æƒ…äº†ã€‚æˆ‘å†™è¿™ä¸ªå¼€æºé¡¹ç›®çš„åˆè¡·ä¸»è¦æœ‰ï¼š

1. ç ”ç©¶å¦‚ä½•ç”¨å¤§è¯­è¨€æ¨¡å‹å¿«é€Ÿç”Ÿæˆè¦†ç›–ä»å°å­¦åˆ°æ•°å­¦ä¸“ä¸š/ç ”ç©¶ç”Ÿéš¾åº¦çš„ï¼Œä¸åŒç±»å‹çš„æ•°å­¦æ•™æ¡ˆã€‚
2. ç ”ç©¶å¦‚ä½•åœ¨å‰ç«¯é¡µé¢åµŒå…¥**GeoGebra**ï¼Œå¢å¼ºæ•°å­¦æ•™æ¡ˆçš„äº’åŠ¨æ€§ã€‚

[æœ¬é¡¹ç›®GitHubä¼ é€é—¨](https://github.com/Hans774882968/teaching-plan-analytic-geometry)

æ³¨æ„ï¼šä¸ºäº†å‡å°‘è¯¥é¡¹ç›®çš„å ç”¨ç©ºé—´ï¼Œæœ¬é¡¹ç›®å¹¶æœªåŒ…å«GeoGebraæºç ã€‚å¦‚æœæƒ³è¦åœ¨æœ¬åœ°è·‘èµ·æ¥è¿™ä¸ªé¡¹ç›®ï¼Œè¯·è‡ªè¡Œä¸‹è½½[GeoGebra Math Apps Bundle](https://download.geogebra.org/package/geogebra-math-apps-bundle)ï¼Œå¹¶å¤åˆ¶é‡Œé¢çš„web3dæ–‡ä»¶å¤¹å’Œcssæ–‡ä»¶å¤¹åˆ°æœ¬é¡¹ç›®çš„`public\geogebra`ã€‚

### 250726ï¼šæœ¬é¡¹ç›®å·²éƒ¨ç½²åˆ° GitHub Pages

[ä¼ é€é—¨](https://hans774882968.github.io/teaching-plan-analytic-geometry)ã€‚æ¬¢è¿å‚è§‚~

ç°é˜¶æ®µçš„æ•´ä½“æ•ˆæœ-PCç«¯ï¼š

![5-ç°é˜¶æ®µçš„æ•´ä½“æ•ˆæœ.png](./README_assets/5-ç°é˜¶æ®µçš„æ•´ä½“æ•ˆæœ.png)

ç§»åŠ¨ç«¯ï¼š

![5-ç°é˜¶æ®µçš„æ•´ä½“æ•ˆæœ-ç§»åŠ¨ç«¯.png](./README_assets/5-ç°é˜¶æ®µçš„æ•´ä½“æ•ˆæœ-ç§»åŠ¨ç«¯.png)

æœ¬æ–‡ 52pojieï¼šhttps://www.52pojie.cn/thread-2048343-1-1.html

æœ¬æ–‡ CSDNï¼šhttps://blog.csdn.net/hans774882968/article/details/149613117

æœ¬æ–‡ juejinï¼šhttps://juejin.cn/post/7530464752063348782

**ä½œè€…ï¼š[hans774882968](https://blog.csdn.net/hans774882968)ä»¥åŠ[hans774882968](https://juejin.cn/user/1464964842528888)ä»¥åŠ[hans774882968](https://www.52pojie.cn/home.php?mod=space&uid=1906177)**

## ã€å›°éš¾ã€‘å¦‚ä½•ç»™Reacté¡¹ç›®æ¥å…¥GeoGebra

ç¿»äº†ä¸‹é«˜ä¸­æ•°å­¦å¿…ä¿®ä¸€ï¼ˆè¿›å…¥ https://jc.pep.com.cn/ ï¼Œé€‰æ‹©é«˜ä¸­æ•°å­¦å¿…ä¿®ç¬¬ä¸€å†ŒBç‰ˆï¼‰ï¼Œç°åœ¨å·²ç»å‡çº§ä¸ºä½¿ç”¨GeoGebraäº†ã€‚æˆ‘è¿˜æ¸…æ¥šåœ°è®°å¾—ï¼Œ15å¹´çš„æ•°å­¦è¯¾æœ¬è¿˜æ˜¯ç”¨å‡ ä½•ç”»æ¿ä¸¾ä¾‹çš„ã€‚

![1-é«˜ä¸­æ•°å­¦å¿…ä¿®ä¸€å·²ç»æ›´æ–°ä¸ºä½¿ç”¨GeoGebra.png](./README_assets/1-é«˜ä¸­æ•°å­¦å¿…ä¿®ä¸€å·²ç»æ›´æ–°ä¸ºä½¿ç”¨GeoGebra.png)

ä¸ºä»€ä¹ˆè¿™ä¸ªé¡¹ç›®è¦æ¥å…¥GeoGebraä¸ç”¨å¤šè¯´äº†å§~ä¼Ÿå¤§ï¼Œæ— éœ€å¤šè¨€ï¼

å‚è€ƒ[GeoGebraå®˜æ–¹æ–‡æ¡£](https://geogebra.github.io/docs/reference/en/GeoGebra_Apps_Embedding/)ï¼Œæˆ‘ä»¬ä¸»è¦éœ€è¦ï¼š

1. å¯¼å…¥ï¼š`<script src="GeoGebra/deployggb.js"></script>`ã€‚
2. å¦‚æœæ˜¯**è‡ªæ‰˜ç®¡**ï¼Œéœ€è¦åŠ ä¸Šè¿™å¥ï¼š`applet.setHTML5Codebase('GeoGebra/HTML5/5.0/web3d/');`ã€‚å¦åˆ™å¿½ç•¥ã€‚

### å°è£… Geogebra.jsx

ä¸ºäº†æ–¹ä¾¿åœ¨Reactä¸­ä½¿ç”¨GeoGebraï¼Œæˆ‘ä»¬ä¸å¦¨å°è£…ä¸€ä¸ª`Geogebra.jsx`ã€‚æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªå«`react-geogebra`çš„npmåŒ…ï¼Œä½†çœ‹äº†çœ¼é‚£ä¸ªæºç ã€‚å¤©å“ªï¼ä»£ç è´¨é‡ä¸å¤ªå¾—ï¼ŒeslintæŠ¥é”™æœ‰åå‡ ä¸ªï¼ç´¢æ€§å¤åˆ¶ä¸‹æ¥ï¼Œè‡ªå·±æ”¹æ”¹ã€‚

[src\component\Geogebra.jsx](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/Geogebra.jsx), copy from https://github.com/pfaffmann/react-geogebra/blob/master/src/index.js

```jsx
import { useEffect, useState, useRef, useCallback } from 'react';
import styles from './Geogebra.module.scss';
import { cn } from '@/lib/utils';

const Geogebra = (props) => {
  const defaultProps = {
    appName: 'classic',
    height: 600,
    showToolBar: true,
    showAlgebraInput: true,
    showMenuBar: true,
  };
  const mergedProps = { ...defaultProps, ...props };
  const refProps = useRef(mergedProps);

  const { onReady, appletOnLoad } = refProps.current;
  let { id, LoadComponent, debug } = refProps.current;
  if (!id) {
    id = 'ggb-applet';
  }
  if (!debug) {
    debug = false;
  }
  // if a JSX Component is not given as a prop, use h3 with children
  if (!LoadComponent) {
    LoadComponent = ({ children }) => <h3>{children}</h3>;
  }

  const [watchPropsChange, setWatchPropsChange] = useState(false);
  // gets called by Geogebra after the Applet is ready
  const onAppletReady = useCallback(
    (ggbApi) => {
      if (appletOnLoad) appletOnLoad(ggbApi);
      if (onReady) onReady();
      debug && console.log(`Applet with id "${id}" is ready`);
    },
    [appletOnLoad, debug, id, onReady]
  );

  useEffect(() => {
    if (window.GGBApplet) {
      const parameter = JSON.parse(JSON.stringify(refProps.current));
      parameter.appletOnLoad = onAppletReady;
      const ggbApp = new window.GGBApplet(parameter, true);
      ggbApp.setHTML5Codebase('/geogebra/web3d/');
      ggbApp.inject(id);
      setWatchPropsChange(false);
      debug &&
        console.log(`applet with id "${id}" successfully injected into the DOM`);
    }

    return () => {
      const tag = document.getElementById(`${id}-holder`);
      if (tag) {
        tag.lastChild.textContent = '';
      }
    };
  }, [watchPropsChange, debug, id, onAppletReady]);

  return (
    <div id={`${id}-holder`} className={cn(styles.geogebraWrapper, props.className)}>
      <div id={id} style={{ width: '100%' }}></div>
    </div>
  );
};

export default Geogebra;
```

è¿™é‡Œçš„æ ¸å¿ƒä»£ç æ˜¯ï¼š

```js
const ggbApp = new window.GGBApplet(parameter, true);
ggbApp.setHTML5Codebase('/geogebra/web3d/');
ggbApp.inject(id);
```

è°ƒç”¨ï¼š

```jsx
<Geogebra
  id="geogebra"
  width={1200}
  height={600}
  showToolbar={true}
  showMenuBar={true}
  allowStyleBar={true}
  showAlgebraInput={true}
  enableLabelDrags={false}
  enableShiftDragZoom={true}
  capturingThreshold={null}
  showToolBarHelp={false}
  errorDialogsActive={true}
  showTutorialLink={true}
/>
```

ç„¶åå°±åˆ°è¸©å‘æ—¶é—´ï¼

### GeoGebra çš„è‡ªæ‰˜ç®¡è§£å†³æ–¹æ¡ˆ

å¦‚æœæŠŠ`ggbApp.setHTML5Codebase('/geogebra/web3d/')`å»æ‰ï¼Œé‚£ä¹ˆgeogebraå·²ç»èƒ½æ­£å¸¸å·¥ä½œï¼Œä½†é™æ€èµ„æºå¿…é¡»é€šè¿‡ç½‘ç»œä¸‹è½½ï¼Œè€Œä¸”èµ„æºæ€»å…±æœ‰å‡ åMBï¼Œæ‰€ä»¥åŠ è½½æ—¶é—´æœ‰ç‚¹é•¿ã€‚äºæ˜¯æˆ‘ä»¬ä¸å¾—ä¸è€ƒè™‘è‡ªæ‰˜ç®¡è§£å†³æ–¹æ¡ˆã€‚

é¦–å…ˆï¼ŒæŒ‰[å®˜æ–¹æ–‡æ¡£](https://geogebra.github.io/docs/reference/en/GeoGebra_Apps_Embedding/)æŒ‡ç¤ºä¸‹è½½[GeoGebra Math Apps Bundle](https://download.geogebra.org/package/geogebra-math-apps-bundle)ï¼Œæ¥ç€è®¾ç½®`ggbApp.setHTML5Codebase('/geogebra/web3d/')`ï¼Œç„¶åæŠŠä¸‹è½½çš„åŒ…çš„web3dæ–‡ä»¶å¤¹å¤åˆ¶åˆ°æœ¬é¡¹ç›®çš„`public\geogebra\web3d`ã€‚

åˆ°æ­¤ä¸ºæ­¢éƒ½è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ã€‚è¿è¡Œï¼ä¸å‡ºæ‰€æ–™ï¼ŒæŠ¥é”™äº†ï¼è¿™æ˜¯å› ä¸ºå®ƒè¯·æ±‚äº† http://localhost:5215/261BBF4225A3B6C8FD1B8B949B793666.cache.js è€Œéé¢„æœŸçš„ http://localhost:5215/geogebra/web3d/261BBF4225A3B6C8FD1B8B949B793666.cache.js ã€‚ç›´æ¥æŒªåŠ¨è¿™ä¸ª`cache.js`ä¼¼ä¹å¯ä»¥è§£å†³ï¼Œä½†ä¸å¤ªä¼˜é›…ã€‚

äºæ˜¯æˆ‘æ’æŸ¥æºç ï¼Œå‘ç°è¿™ä¸ªcacheæ–‡ä»¶çš„è·¯å¾„æ˜¯ç”±`web3d.__moduleBase`ï¼ˆä½äº`geogebra\web3d\web3d.nocache.js`ï¼‰å†³å®šçš„ã€‚æœç´¢è¿™ä¸ªå˜é‡åï¼Œå‘ç°`web3d.__moduleBase = B()`è¿™å¥èµ‹å€¼å†³å®šäº†å…¶å€¼ï¼Œå¤–éƒ¨æ²¡æ³•ç›´æ¥ä¿®æ”¹å®ƒã€‚æ‰€ä»¥æˆ‘ä»¬ç»§ç»­çœ‹Bå‡½æ•°ï¼Œå‘ç°æœ€ç»ˆæ˜¯è¿™å¥ä»£ç å†³å®šå…¶è·¯å¾„ï¼š

```js
// geogebra\web3d\web3d.nocache.js
// æˆ‘æŠŠåŸæœ‰ä»£ç çš„ O, P, W ç­‰è¿˜åŸä¸ºå¸¸é‡
function e(a) {
  var b = a.lastIndexOf('#');
  if (b == -1) {
    b = a.length;
  }
  var c = a.indexOf('?');
  if (c == -1) {
    c = a.length;
  }
  var d = a.lastIndexOf('/', Math.min(c, b));
  return d >= 0 ? a.substring(0, d + 1) : '';
}

if(k == W && j()) {k = e(o.location.href);}
k = f(k);
return k;
```

æˆ‘ä»¬æŠŠå®ƒæ”¹æˆ`k = e(o.location.href + 'geogebra/web3d/');`ï¼Œé—®é¢˜è§£å†³ï¼

#### 250629æ›´æ–°

æ¥å…¥react-routeråï¼Œéœ€è¦æ”¹ä¸º`k = e('/geogebra/web3d/');`ã€‚

#### 250726æ›´æ–°

ä¸ºäº†èƒ½å¤Ÿéƒ¨ç½²åˆ°GitHub Pagesï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥æ›´æ–°ä¸ºï¼š`k = e(window.GGB_WEB3D_NO_CACHE_BASE_PATH);`ã€‚è¿™ä¸ªå…¨å±€å˜é‡æˆ‘ä»¬çº¦å®šåœ¨`main.jsx`è®¾ç½®ï¼š

```js
window.GGB_WEB3D_NO_CACHE_BASE_PATH = getGeogebraHTML5Codebase();

// src\lib\getWebsiteBasePath.js
export function getGeogebraHTML5Codebase() {
  const isGitHubPages = import.meta.env.VITE_DEPLOY_TARGET === 'github-pages';
  const codebase = isGitHubPages ? `${GITHUB_PAGE_BASE}geogebra/web3d/` : '/geogebra/web3d/';
  return codebase;
}
```

è¯¦è§åæ–‡ã€Šéƒ¨ç½²åˆ°GitHub Pagesã€‹ä¸€èŠ‚ã€‚

ä¹‹åå‘ç°ï¼Œæ§åˆ¶å°æ²¡æœ‰æŠ¥é”™äº†ï¼Œä½†æ ·å¼ä¸å¯¹åŠ²ã€‚è¿™æ˜¯å› ä¸ºå®ƒè¯·æ±‚äº†`geogebra/css/...`ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åªå¤åˆ¶web3dæ–‡ä»¶å¤¹ï¼Œè¿˜è¦æŠŠåŒçº§çš„cssæ–‡ä»¶å¤¹å¤åˆ¶è¿‡å»ã€‚è‡³æ­¤æå®šï¼

### GeoGebra çš„ç¥ç§˜ bug

æ‰“å¼€æ§åˆ¶å°ï¼Œçª—å£è‡ªåŠ¨ç¼©å°ï¼Œæ­¤æ—¶ç‚¹å‡»è®¾ç½®ï¼Œé€‰æ‹©åæ ‡è½´çš„é¢œè‰²ï¼Œä¼šå‘ç°ç‚¹å‡»å¯¹åº”æ ¼å­ï¼Œé€‰ä¸­çš„é¢œè‰²å´ä¸æ˜¯é¼ æ ‡å¯¹åº”çš„æ ¼å­çš„é¢œè‰²ã€‚æŠŠæ§åˆ¶å°å…³äº†ï¼Œçª—å£æ— æ³•å›åˆ°åŸæ¥çš„å¤§å°ï¼Œäºæ˜¯é—®é¢˜è¿˜åœ¨ã€‚æ§åˆ¶å°ä»æœªå¼€å¯åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚

### GeoGebra æ¥å…¥æ€»ç»“

1. æŒ‰å®˜æ–¹æ–‡æ¡£è¯´çš„åšã€‚
2. å¤åˆ¶web3då’Œcssä¸¤ä¸ªæ–‡ä»¶å¤¹åˆ°`public\geogebra`ã€‚
3. `geogebra\web3d\web3d.nocache.js`çš„`k = e(o.location.href)`æ”¹æˆ`k = e('/geogebra/web3d/');`ã€‚

## ç”¨GeoGebraè¿›è¡Œæ•°å­¦æ•™å­¦

å¯å‚è€ƒ[docs\Geogebraç»„ä»¶æ–‡æ¡£.md](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/docs/Geogebra%E7%BB%84%E4%BB%B6%E6%96%87%E6%A1%A3.md)ã€‚ä¸‹é¢ä»…ç»™å‡ºéªŒè¯æ¤­åœ†ç¬¬ä¸€å®šä¹‰çš„ç¤ºä¾‹è„šæœ¬ï¼š

```jsx
const drawEllipse = (applet) => {
  applet.evalCommand('ellipse: x^2/25 + y^2/9 = 1'); // ç»˜åˆ¶æ¤­åœ†
  applet.setColor('ellipse', 255, 0, 0);
  applet.setLineThickness('ellipse', 3);
  applet.setCaption('ellipse', 'æ¤­åœ†: \\frac{x^2}{25} + \\frac{y^2}{9} = 1');

  applet.evalCommand('A: Point(ellipse)'); // ç»˜åˆ¶æ¤­åœ†ä¸Šçš„åŠ¨ç‚¹ A
  applet.evalCommand('C1: (4, 0)'); // ç»˜åˆ¶æ¤­åœ†çš„å³ç„¦ç‚¹ C1
  applet.evalCommand('C2: (-4, 0)'); // ç»˜åˆ¶æ¤­åœ†çš„å·¦ç„¦ç‚¹ C2
  applet.evalCommand('s1: Segment(C1, A)'); // çº¿æ®µ C1A
  applet.evalCommand('s2: Segment(C2, A)'); // çº¿æ®µ C2A
  applet.evalCommand('lenSum: s1 + s2'); // éªŒè¯æ¤­åœ†ä¸Šä»»æ„ä¸€ç‚¹ A åˆ°ä¸¤ä¸ªç„¦ç‚¹çš„è·ç¦»å’Œä¸ºå®šå€¼

  applet.setCoordSystem(-6, 6, -4, 4);
};

<Geogebra
  id="geogebra"
  width={1200}
  height={600}
  appletOnLoad={drawEllipse}
/>
```

### å¦‚ä½•å¿«é€Ÿå­¦ä¹ GeoGebraçš„è¯­æ³•ï¼Ÿä»¥â€œåŒæ›²çº¿çš„åå‡½æ•°â€ä¸ºä¾‹

é™¤äº†çœ‹å®˜æ–¹æ–‡æ¡£ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ›´ç®€å•çš„æ–¹å¼ï¼š

1. æ“ä½œä¸€ä¸‹è½¯ä»¶çš„ä¸Šæ–¹å·¥å…·æ ï¼Œæ¯”å¦‚â€œReflect about Pointâ€ï¼ˆè®¾ç½®å…³äºç‚¹Aå…³äºç‚¹Bå¯¹ç§°çš„ç‚¹ï¼‰ï¼Œç„¶åç‚¹å‡»å¹³é¢ç›´è§’åæ ‡ç³»ä¸­å·²æœ‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯ä¸¤ä¸ªç‚¹ï¼Œå°±èƒ½çœ‹åˆ°ç­‰å¼åˆ—è¡¨æ–°å¢äº†ä¸€æ¡ç­‰å¼ã€‚
2. å¯ä»¥çŒœæµ‹â€œReflect about Pointâ€çš„å‘½ä»¤å«æœ‰Reflectå­—æ ·ï¼Œåœ¨ç­‰å¼è¾“å…¥æ¡†è¾“å…¥â€œReflectâ€ï¼Œä¾¿èƒ½æ ¹æ®è½¯ä»¶çš„æç¤ºæ–¹ä¾¿åœ°è¡¥å…¨å‘½ä»¤ã€‚

å¦å¤–ï¼Œæˆ‘è¿˜å°è¯•é—®DeepSeekï¼š

> å¤§ä½¬ï¼Œæˆ‘æœ‰å¦‚ä¸‹Geogebraä»£ç ï¼š/* çœç•¥ */ã€‚è¯·é—®å¦‚ä½•å†™ä»£ç éªŒè¯A0ç‚¹ç¡®å®åœ¨hyperbola2ä¸Š

å®ƒç¡®å®å›ç­”å‡ºæ¥äº†ï¼Œä½†ç»™çš„å›ç­”å¤ªå¤æ‚äº†ã€‚å…¶å®ï¼Œâ€œéªŒè¯åŒæ›²çº¿çš„åå‡½æ•°è¿˜æ˜¯åŒæ›²çº¿â€å¯ä»¥é€šè¿‡Reflectå’ŒDistanceå‘½ä»¤ç®€å•å®ç°ã€‚å¦‚ä¸‹ï¼ˆæ¥è‡ª[src\hyperbolaDefinition\config.jsx](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/hyperbolaDefinition/config.jsx)ï¼‰ï¼š

```js
(applet) => {
  applet.evalCommand('hyperbola1: x^2/16 - y^2/9 = 1');
  applet.setColor('hyperbola1', 255, 0, 0);
  applet.setLineThickness('hyperbola1', 3);
  applet.evalCommand('hyperbola2: y^2/16 - x^2/9 = 1');
  applet.setColor('hyperbola2', 0, 0, 255);
  applet.setLineThickness('hyperbola2', 3);

  applet.evalCommand('A: Point(hyperbola1)');
  applet.evalCommand('l: y = x');
  applet.evalCommand('A\': Reflect(A, l)');
  applet.setLineThickness('l', 1);
  applet.evalCommand('Distance(A\', hyperbola2)');

  applet.setCoordSystem(-10, 10, -8, 8);
}
```

## åœ¨Reacté¡¹ç›®ä¸­ç”¨`framer-motion`å®ç°åŠ¨ç”»

`framer-motion`å…¶å®å¾ˆå¼ºå¤§ï¼Œä½†æ˜¯æˆ‘åœ¨æ­¤åªæ˜¯æŠŠå®ƒå½“ä½œCSSåŠ¨ç”»çš„è¯­æ³•ç³–ã€‚çœ‹ä¸€ä¸ªä¾‹å­å°±ç§’æ‡‚äº†ï¼ˆ[`src\TeachingPlanList.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/TeachingPlanList.jsx)ï¼‰ï¼š

```jsx
<motion.div
  initial={{ opacity: 0, y: 20 }}
  animate={{ opacity: 1, y: 0 }}
  transition={{ duration: 0.5, delay: index * 0.1 }}
  whileHover={{ scale: 1.03 }}
  className={cn(
    styles.lessonCard,
    styles.bounceInAnimation,
    'bg-white rounded-xl overflow-hidden shadow-lg'
  )}
/>
```

`y`æ§åˆ¶ç›’å­å¾€ä¸Šé£ï¼Œé¼ æ ‡æ”¾ä¸Šå»ç›’å­ä¼šå˜å¤§ã€‚

## ã€å¸¸è§„ã€‘Reacté¡¹ç›®å¦‚ä½•æ”¯æŒKatexå…¬å¼

### åœ¨ ReactNode ä¸­ï¼š@matejmazur/react-katex

ç›¸å…³æ–‡ä»¶ï¼š

- `src\ellipseDefinition\EllipseDefinition.jsx`
- `src\ellipseDefinition\config.jsx`

é¦–å…ˆ

```powershell
bun add katex @matejmazur/react-katex
```

æ¥ç€åœ¨`src\App.jsx`ï¼š

```jsx
import 'katex/dist/katex.min.css';
```

ç„¶åç›´æ¥å¼•ç”¨ï¼š

```jsx
import TeX from '@matejmazur/react-katex';

<TeX>{'c = \\sqrt{a^2 - b^2}'}</TeX>
<TeX block>{String.raw`\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1`}</TeX>
```

å› ä¸ºæˆ‘å¸Œæœ›DeepSeekç”Ÿæˆä¸€ä¸ª`config.js`çš„Schemaæ–¹ä¾¿åç»­é…ç½®ï¼Œæ‰€ä»¥æˆ‘å®é™…ä¸Šæ˜¯åœ¨`src\ellipseDefinition\config.jsx`å¯¼å…¥çš„`TeX`ã€‚å¤§è‡´æ–¹æ¡ˆå¦‚ä¸‹ï¼š

configé…ç½®ç¤ºä¾‹ï¼š

```jsx
export const config = {
  properties: {
    title: 'æ¤­åœ†çš„é‡è¦æ€§è´¨',
    items: [
      <><strong className="highlight">ç¦»å¿ƒç‡</strong>ï¼š<TeX>{'e = \\frac{c}{a} \\ (0 < e < 1)'}</TeX>ï¼Œè¡¨ç¤ºæ¤­åœ†çš„æ‰å¹³ç¨‹åº¦</>,
      <><strong className="highlight">ç„¦ç‚¹æ€§è´¨</strong>ï¼šä»æ¤­åœ†ä¸€ä¸ªç„¦ç‚¹å‘å‡ºçš„å…‰çº¿ï¼Œç»æ¤­åœ†åå°„åä¼šç»è¿‡å¦ä¸€ä¸ªç„¦ç‚¹</>,
      <><strong className="highlight">å¯¹ç§°æ€§</strong>ï¼šæ¤­åœ†å…³äºé•¿è½´ã€çŸ­è½´å’Œä¸­å¿ƒå¯¹ç§°</>,
      <><strong className="hard">é¢ç§¯å…¬å¼</strong>ï¼š<TeX>{'S = \\pi \\times a \\times b'}</TeX></>,
    ],
  },
}
```

`EllipseDefinition.jsx`è°ƒç”¨ï¼š

```jsx
<div className="knowledge-point">
  <h3>ğŸ” {config.properties.title}</h3>
  {config.properties.items.map((item, i) => (
    <p key={i}>{i + 1}. {item}</p>
  ))}
</div>
```

### åœ¨ Markdown String ä¸­ï¼šmarked + marked-katex-extension

ä¸ºäº†æ–¹ä¾¿LLMç”Ÿæˆè¯¾ä»¶ï¼Œæˆ‘ä»¬éœ€è¦è®©é¡¹ç›®æ”¯æŒæ¸²æŸ“Markdownã€‚ä¹‹åæˆ‘ä»¬åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å†™Markdownå­—ç¬¦ä¸²å³å¯ã€‚ä¸ºäº†åœ¨markedä¸­æ”¯æŒKatexå…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªrendererï¼ˆæˆ‘ç¡®å®æœ‰æœåˆ°é‡‡ç”¨è¿™ç§æ–¹æ¡ˆçš„ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨ç°æˆçš„åŒ…ï¼š`marked-katex-extension`ã€‚

é¦–å…ˆ

```powershell
bun add marked highlight.js marked-katex-extension
```

æ¥ç€æˆ‘ä»¬å¯ä»¥ç›´æ¥å®ç°ä¸€ä¸ªReactç»„ä»¶[`src\component\MarkdownRenderer.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/MarkdownRenderer.jsx)ï¼Œè°ƒç”¨markedï¼Œæ¸²æŸ“Markdown Stringï¼š

```jsx
import { processMarkdown } from '@/lib/marked';
import { useEffect, useState } from 'react';
import { cn } from '@/lib/utils';
import 'highlight.js/styles/paraiso-light.css';
import useCodeBlockSetup from '../hooks/useCodeBlockSetup';
import './MarkdownRenderer.scss';

export default function MarkdownRenderer({ className, content, ...rest }) {
  const [htmlContent, setHtmlContent] = useState('');
  const [isLoading, setIsLoading] = useState(false);

  const tpmMdContainerRef = useCodeBlockSetup();

  useEffect(() => {
    setIsLoading(true);
    const parseResult = processMarkdown(content);
    parseResult
      .then(result => {
        setHtmlContent(result);
        setIsLoading(false);
      })
      .catch(error => {
        console.error('Error processing markdown:', error);
        setHtmlContent(content);
        setIsLoading(false);
      });
  }, [content]);

  if (isLoading) {
    return <div className={className} {...rest}>åŠ è½½ä¸­...</div>;
  }
  if (typeof content === 'string') {
    return (
      <div
        ref={tpmMdContainerRef}
        dangerouslySetInnerHTML={{ __html: htmlContent }}
        className={cn('tpm-markdown-container max-w-none', className)}
        {...rest}
      />
    );
  }
  return content;
}
```

æˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠmarkedåˆå§‹åŒ–`marked-katex-extension`ç­‰æ’ä»¶çš„ä»£ç å†™åœ¨jsxæ–‡ä»¶é‡Œï¼Œä½†ä¸ºäº†è®©ä»£ç æ›´æ¸…æ™°ï¼Œæˆ‘ä»¬ä¸å¦¨æŠ½å‡ºä¸€ä¸ªæ–‡ä»¶`src\lib\marked.js`ï¼Œä¸“é—¨å¤„ç†markedçš„åˆå§‹åŒ–ï¼š

```js
import { marked } from 'marked';
import markedKatex from 'marked-katex-extension';
import { markedHighlight } from 'marked-highlight';
import hljs from 'highlight.js';

// ä¸ºäº†ç®€å•ï¼Œå…ˆä½¿ç”¨ marked-highlight ï¼Œåé¢ä¼šæ”¹æˆå¤æ³•æ‰‹ä½œ renderer
marked.use(
  markedHighlight({
    emptyLangClass: 'hljs',
    langPrefix: 'hljs language-',
    highlight(code, lang) {
      const language = hljs.getLanguage(lang) ? lang : 'plaintext';
      return hljs.highlight(code, { language }).value;
    },
  })
);

marked.use(markedKatex({
  throwOnError: false,
}));

/**
 * æ³¨æ„ï¼š
 * 1. markdown æ–‡æœ¬å°½é‡ä¸è¦ä»¥å¤šä½™çš„ç©ºæ ¼å¼€å¤´ï¼Œå¦åˆ™ marked ä¼šå°†å…¶è§£æä¸ºä»£ç å—ï¼Œå¯¼è‡´ç»“æœä¸åˆé¢„æœŸ
 * 2. katex æ ¼å¼çš„å…¬å¼å’Œå‰é¢çš„æ–‡æœ¬ç•™ä¸€ä¸ªç©ºæ ¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™
 * @param {string} _content markdown content
 * @returns {string} html or content
 */
export const processMarkdown = async (_content) => {
  if (typeof _content !== 'string') {
    return _content;
  }
  // _content ä»¥ white spaces å¼€å¤´æ—¶ï¼Œmarked ä¼šå°†å…¶è§£æä¸ºä»£ç å—ï¼Œå› æ­¤è¦ trim
  const content = _content.trim();
  // Handle both Promise and string return types from marked()
  const result = marked(content);
  const html = typeof result === 'string' ? result : await result;
  return html;
  // TODO: æ¥å…¥ sanitize html ä¼šå¯¼è‡´ style å±æ€§è¢«åï¼Œè®¾ç½® allowedAttributes æœªç”Ÿæ•ˆ
};

```

è¿™é‡Œæœ‰ä¸€ä¸ªæ‚¬è€Œæœªå†³çš„é—®é¢˜ï¼šæ¥å…¥`sanitize-html`ä¼šå¯¼è‡´ style å±æ€§è¢«åï¼Œå¯¼è‡´Katexå‡ºç°æ ·å¼é”™è¯¯ã€‚å®˜æ–¹æ–‡æ¡£è¯´è®¾ç½®`allowedAttributes`å°±è¡Œï¼Œä½†æˆ‘è®¾ç½®ä»¥åæ²¡ç”Ÿæ•ˆã€‚æˆ‘æ‡’å¾—ç ”ç©¶è¿™ä¸ªäº†ï¼Œå…ˆæ”¾ç€å§ã€‚

## ã€å¸¸è§„ã€‘æ•°å­¦æ•™æ¡ˆç”Ÿæˆæ–¹æ¡ˆæ¢ç©¶ï¼šä»æŠ½è±¡å‡ºæ­ç§¯æœ¨çš„ç»„ä»¶ï¼Œåˆ°å½»åº•SchemaåŒ–

æˆ‘æœ€åˆçš„æƒ³æ³•æ˜¯ï¼Œå…ˆç”¨DeepSeekç›´æ¥ç”Ÿæˆç¬¬ä¸€ä¸ªæ•™æ¡ˆã€Šæ¤­åœ†çš„å®šä¹‰ä¸æ€§è´¨ã€‹çš„HTMLä»£ç ï¼Œæ¥ç€å°†å…¶æ”¹é€ ä¸ºReactä»£ç ï¼Œç„¶åç¼–å†™è§„èŒƒï¼Œè®©LLMæ ¹æ®è§„èŒƒç”Ÿæˆå…¶ä»–æ•°å­¦æ•™æ¡ˆçš„Reactç»„ä»¶å’Œ`config.jsx`ã€‚ä½†æˆ‘å‘ç°äº†ä¸å°‘ç—›ç‚¹ï¼š

1. LLMç”Ÿæˆçš„æ•™æ¡ˆå’Œå·²æœ‰çš„æ•™æ¡ˆä»£ç é‡‡ç”¨å®Œå…¨ä¸ä¸€æ ·çš„ä»£ç è§„èŒƒã€ä¸ä¸€æ ·çš„æŠ€æœ¯é€‰å‹ã€ä¸ä¸€æ ·çš„CSSä»£ç ã€‚è¦åœ¨ä¸€ä¸ªå•é¡µåº”ç”¨ä¸­ç»Ÿä¸€å®ƒä»¬å­˜åœ¨å›°éš¾ã€‚
2. çœ‹ä¼¼è®©LLMç”Ÿæˆå®Œæ•´HTMLä»£ç çš„æ–¹æ¡ˆå¯ä»¥æ¿€å‘å…¶åˆ›é€ åŠ›ï¼Œä½†å®æµ‹å‘ç°ï¼ŒLLMçœŸçš„å¾ˆæ‡’ï¼Œå†™ä¸œè¥¿è¯­ç„‰ä¸è¯¦ï¼Œä¹Ÿä¸æ€ä¹ˆç”Ÿæˆç¬¬ä¸€ä¸ªæ•™æ¡ˆå®Œå…¨æ²¡æœ‰çš„æ–°ä¸œè¥¿ã€æ–°æ¨¡å¼ã€‚

ä½†æˆ‘çš„å¹»æƒ³è¿˜æ²¡å®Œå…¨ç£¨ç­ã€‚æˆ‘æƒ³ç€ï¼ŒæŠ½è±¡å‡ºä¸€äº›ç»„ä»¶ï¼Œè®©LLMåƒæ­ç§¯æœ¨ä¸€æ ·æ­å‡ºé¡µé¢ï¼Œä¹Ÿè®¸èƒ½æ¿€å‘å…¶åˆ›é€ åŠ›ã€‚äºæ˜¯æœ‰äº†[docs\æ–°è¯¾ä»¶æç¤ºè¯\ç”Ÿæˆjsx.md](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/docs/%E6%96%B0%E8%AF%BE%E4%BB%B6%E6%8F%90%E7%A4%BA%E8%AF%8D/%E7%94%9F%E6%88%90jsx.md)è¿™ä¸ªæç¤ºè¯æ–‡ä»¶ï¼Œä»¥åŠä¸‹é¢è¿™äº›ç»„ä»¶ï¼š

```jsx
import Section from '@/component/teachingPlan/Section';
import KnowledgePoint from '@/component/teachingPlan/KnowledgePoint';
import Card from '@/component/teachingPlan/Card';
import Header from '@/component/teachingPlan/Header';
import LearningPartnerCard from '@/component/teachingPlan/LearningPartnerCard';
import Think from '@/component/teachingPlan/Think';
import Footer from '@/component/teachingPlan/Footer';
```

- @/src\component\teachingPlan\Section.jsx ï¼šåŒ…è£¹æ¯ä¸ªæ¨¡å—
- @/src/component/teachingPlan/KnowledgePoint.jsx ï¼šåŒ…è£¹ä¸€ä¸ªçŸ¥è¯†ç‚¹
- @/src\component\teachingPlan\Card.jsx ï¼šå¯ç”¨äºåŒ…è£¹å„ç§å†…å®¹
- @/src\component\teachingPlan\Header.jsx ï¼šæ ‡é¢˜æ 
- @/src\component\teachingPlan\LearningPartnerCard.jsx ï¼šå­¦ä¹ ä¼™ä¼´
- @/src/component/teachingPlan/Think.jsx ï¼šåŒ…è£¹ä¸€é“æ€è€ƒé¢˜ã€‚è¯¥ç»„ä»¶å¯å‡ºç°åœ¨ KnowledgePoint æˆ– Card ä¸­ã€‚å¦‚æœåœ¨ Card ä¸­ï¼Œåˆ™å®ƒæ˜¯ KnowledgePoint çš„ sibling
- @/src\component\teachingPlan\Footer.jsx ï¼šé¡µè„š

ä½†æˆ‘å‘ç°ï¼Œåªè¦ä¿ç•™è‡ªç”±åº¦ï¼Œä»ç„¶å…è®¸LLMç”Ÿæˆæ•´ä¸ªé¡µé¢Reactç»„ä»¶ï¼Œä¸Šé¢çš„ç—›ç‚¹1å’Œ2å°±æ— æ³•è§£å†³ã€‚æˆ‘ä»ç„¶éœ€è¦æ‰‹åŠ¨æ›´æ”¹å¤§é‡ä»£ç ã€‚æ—¢ç„¶LLMåœ¨æ•™æ¡ˆç”Ÿæˆæ–¹é¢å°±æ˜¯æ²¡å•¥åˆ›é€ åŠ›ï¼Œæˆ‘å°±æƒ³ï¼Œå¹²è„†å½»åº•SchemaåŒ–ï¼Œé¡µé¢ä¸€å¾‹ç”¨æ ‡å‡†é¡µé¢ç”Ÿæˆç®—äº†ã€‚è¿™æ ·ï¼ŒLLMä¹Ÿèƒ½ä¸“æ³¨äºå†…å®¹ï¼Œå°±åƒåœ¨ç”Ÿæˆç”¨äºMarpäº§å‡ºPPTæ–‡ä»¶çš„Markdownæ–‡æ¡£ä¸€æ ·ã€‚

äºæ˜¯æœ‰äº†ï¼š

1. [docs\æ–°è¯¾ä»¶æç¤ºè¯\ç”Ÿæˆschema.md](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/docs/%E6%96%B0%E8%AF%BE%E4%BB%B6%E6%8F%90%E7%A4%BA%E8%AF%8D/%E7%94%9F%E6%88%90schema.md)
2. é¡µé¢ç»“æ„çš„ç±»å‹æè¿°ï¼š[src\component\teachingPlan\StandardPageStructure.d.ts](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/teachingPlan/StandardPageStructure.d.ts)
3. æ ‡å‡†é¡µé¢ï¼š[src\component\teachingPlan\StandardPage.jsx](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/teachingPlan/StandardPage.jsx)

æˆ‘å†³å®šå…ˆç”¨æç¤ºè¯ã€Šç”Ÿæˆschema.mdã€‹ç”Ÿæˆã€Šå¹³é¢å‘é‡çš„å®šä¹‰åŠå…¶çº¿æ€§è¿ç®—ã€‹è¯¾ä»¶çš„`src\planeVectorDefinition\config.jsx`ï¼Œå†çœ‹DeepSeekçš„åé¦ˆæ…¢æ…¢è°ƒæ•´æç¤ºè¯ã€‚å®éªŒè¡¨æ˜ï¼Œè¿™æ¡è·¯èµ°å¾—é€šï¼Œåªéœ€è¦ä¾æ®DeepSeekæ¬ è€ƒè™‘çš„ç‚¹å¾®è°ƒä¸Šè¿°å‡ ä¸ªæ–‡æ¡£å³å¯ã€‚TODO: å¼€å‘ä¸€ä¸ªç½‘é¡µï¼Œæ–¹ä¾¿åœ°å®Œæˆæç¤ºè¯çš„æ‹¼æ¥ã€‚å·¦è¾¹æ˜¯ç¼–è¾‘å™¨ï¼Œå³è¾¹æ˜¯é¢„è§ˆåŒºã€‚ä»ç„¶æ˜¯ç”¨viteçš„è™šæ‹Ÿæ¨¡å—å®ç°ã€‚

### ã€å¸¸è§„ã€‘Viteçš„è™šæ‹Ÿæ¨¡å—ï¼šåœ¨é¡µé¢ä¸­å±•ç¤ºæç¤ºè¯çš„Markdownæ–‡æ¡£

æˆ‘å¸Œæœ›åœ¨æˆ‘çš„ç½‘ç«™å±•ç¤ºé¡¹ç›®ç”¨åˆ°çš„æç¤ºè¯ã€‚è¿™æ˜¯ä¸€ç±»é™æ€ç«™ç‚¹ç”Ÿæˆçš„éœ€æ±‚ï¼Œvitepressä¹‹ç±»çš„æ¡†æ¶éƒ½æœ‰è¿™ä¸ªèƒ½åŠ›ï¼Œä½†æˆ‘ä»¬åœ¨æ­¤æƒ³è¦ä¸€ä¸ªè¶³å¤Ÿè½»é‡çš„æ–¹æ¡ˆã€‚æˆ‘é€šè¿‡æœç´¢å¼•æ“å·²ç»äº†è§£åˆ°ï¼ŒViteçš„**è™šæ‹Ÿæ¨¡å—**å€Ÿç”¨äº†Viteçš„å¼€å‘æœåŠ¡å™¨çš„èƒ½åŠ›ï¼Œå¯ä»¥è¾¾åˆ°ç±»ä¼¼äºåç«¯æ¥å£çš„æ•ˆæœã€‚

äºæ˜¯æˆ‘é—®DeepSeekï¼šâ€œå¤§ä½¬ï¼Œä½ æ˜¯ä¸€åä¸“å®¶å‰ç«¯å·¥ç¨‹å¸ˆï¼Œç²¾é€šå‰ç«¯å·¥ç¨‹åŒ–ã€‚è¯·å«æˆ‘hans7ã€‚æˆ‘æœ‰ä¸€ä¸ªReact+vite+react-router-dom+markedçš„é¡¹ç›®ï¼Œå¸Œæœ›å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼šåœ¨æ‰“åŒ…æ—¶èƒ½å¤Ÿè¯»å–ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„markdownæ–‡ä»¶çš„å†…å®¹ï¼Œå¦‚README.mdï¼Œé€šè¿‡markedæ¸²æŸ“ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶çš„è·¯ç”±æ˜¯/prompt-displayã€‚è¯·é—®å¦‚ä½•ç”¨è‡ªå®šä¹‰viteæ’ä»¶å®ç°ï¼Ÿâ€DeepSeekç»™äº†æˆ‘å®Œæ•´ä»£ç ï¼Œå¯æƒœå®ƒçš„ä»£ç ä¸èƒ½è·‘ï¼Œå› ä¸ºViteçš„è™šæ‹Ÿæ¨¡å—ä¸æ”¯æŒJSXã€‚æ‰€ä»¥æˆ‘æ”¹äº†ä¸‹ä»£ç ï¼Œè®©è™šæ‹Ÿæ¨¡å—ä»…è¿”å›markdownå­—ç¬¦ä¸²ã€‚[`src\plugins\vite-plugin-prompt-display.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/plugins/vite-plugin-prompt-display.js)ï¼š

```js
import fs from 'fs';
import path from 'path';

const genSchemaPromptPath = path.resolve(process.cwd(), 'docs', 'æ–°è¯¾ä»¶æç¤ºè¯', 'ç”Ÿæˆschema.md');
const genSchemaRelativePath = path.relative(process.cwd(), genSchemaPromptPath);
const genJsxPromptPath = path.resolve(process.cwd(), 'docs', 'æ–°è¯¾ä»¶æç¤ºè¯', 'ç”Ÿæˆjsx.md');
const genJsxRelativePath = path.relative(process.cwd(), genJsxPromptPath);
const promptFilePaths = [genSchemaPromptPath, genJsxPromptPath];

function getEncodedPromptContent(filePath) {
  const content = fs.readFileSync(filePath, 'utf-8');
  return encodeURI(content);
}

export default function promptDisplayPlugin() {
  const virtualModuleId = 'virtual:prompt-display';
  const resolvedVirtualModuleId = '\0' + virtualModuleId;

  return {
    name: 'vite-plugin-prompt-display',
    configureServer(server) {
      // ç›‘å¬æç¤ºè¯æ–‡ä»¶å˜åŒ–
      promptFilePaths.forEach((promptFilePath) => {
        server.watcher.add(promptFilePath);
      });

      // æ–‡ä»¶å˜åŒ–æ—¶è§¦å‘ HMR
      server.watcher.on('change', (file) => {
        if (!promptFilePaths.includes(file)) {
          return;
        }
        // 1. ä½¿è™šæ‹Ÿæ¨¡å—ç¼“å­˜å¤±æ•ˆ
        const module = server.moduleGraph.getModuleById(resolvedVirtualModuleId);
        if (module) {
          server.moduleGraph.invalidateModule(module);
        }

        // 2. é€šçŸ¥å®¢æˆ·ç«¯é‡æ–°åŠ è½½æ¨¡å—
        server.ws.send({
          type: 'full-reload',
          path: '*',
        });

        console.log('[tpm] ğŸ“„ æç¤ºè¯æ–‡ä»¶æ›´æ–°', file);
      });
    },
    resolveId(id) {
      if (id === virtualModuleId) return resolvedVirtualModuleId;
    },
    load(id) {
      if (id === resolvedVirtualModuleId) {
        const genSchemaPromptContent = getEncodedPromptContent(genSchemaPromptPath);
        const genJsxPromptContent = getEncodedPromptContent(genJsxPromptPath);

        return `
          export const genSchemaRelativePath = String.raw\`${genSchemaRelativePath}\`;
          export const genJsxRelativePath = String.raw\`${genJsxRelativePath}\`;

          export const genSchemaPrompt = decodeURI(\`${genSchemaPromptContent}\`);
          export const genJsxPrompt = decodeURI(\`${genJsxPromptContent}\`);
        `.trim();
      }
    },
  };
}
```

ä¸€äº›è¯´æ˜ï¼š

1. è¿™ä¸ªè™šæ‹Ÿæ¨¡å—çš„æ ¼å¼æŒºæ ‡å‡†çš„ï¼Œé€‚åˆæ•™å­¦ã€‚
2. ä¹‹æ‰€ä»¥ä½¿ç”¨`decodeURI`æ˜¯å› ä¸ºåŸå§‹å­—ç¬¦ä¸²æœ‰å•å¼•å·ã€åŒå¼•å·ä¹‹ç±»çš„å­—ç¬¦ï¼Œæ— æ³•ç›´æ¥æ‹¼æ¥ä¸ºJSä»£ç ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ç§æœ€ç®€å•çš„æ–¹å¼è½¬ä¹‰è¿™äº›å­—ç¬¦ã€‚
3. è¿™ç‰ˆä»£ç å’Œæœ€æ–°ç‰ˆä»£ç åŠŸèƒ½ä¸€è‡´ï¼ŒåŒºåˆ«æ˜¯æœ€æ–°ç‰ˆå°è£…äº†ä¸¤ä¸ªå‡½æ•°ã€‚

åœ¨Reactç»„ä»¶ä¸­ï¼Œç›´æ¥åƒimportå…¶ä»–æ–‡ä»¶ä¸€æ ·importå³å¯ï¼š

```js
import {
  genSchemaPrompt,
  genSchemaRelativePath,
} from 'virtual:prompt-display';
```

æŸ¥çœ‹æ‰“åŒ…äº§ç‰©å¯çŸ¥ï¼ŒMarkdownå­—ç¬¦ä¸²ä¼šåœ¨æ„å»ºé˜¶æ®µè¢«å®Œæ•´åœ°æ‰“åŒ…è¿›JSæ–‡ä»¶ã€‚

### åœ¨ç½‘ç«™ä¸­å±•ç¤ºREADME

ç±»ä¼¼åœ°ï¼Œæˆ‘è¿˜åœ¨ç½‘ç«™ä¸­å±•ç¤ºäº†`README.md`ï¼Œä¼ é€é—¨ï¼š[`src\plugins\vite-plugin-readme-display.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/plugins/vite-plugin-readme-display.js)ã€‚æˆ‘é¡¹ç›®çš„READMEæœ‰å›¾ç‰‡ï¼Œæ‰€ä»¥è¿˜éœ€è¦æ‰‹åŠ¨æŠŠå›¾ç‰‡å¤åˆ¶åˆ°`dist`æ–‡ä»¶å¤¹ã€‚é…ç½®`rollup-plugin-copy`ï¼š

```js
 import copy from 'rollup-plugin-copy';

    copy({
      targets: [
        { src: 'README_assets', dest: 'dist' },
      ],
      hook: 'writeBundle',
    }),
```



### æç¤ºè¯ç¼ºé™·ä¿®å¤æŠ€å·§ä¸¾ä¾‹

å†™ä¸€ä¸ª**å¤šæ¬¡ä½¿ç”¨çš„æ¨¡æ¿æç¤ºè¯**ï¼ˆåœ¨æœ¬èŠ‚ä¸­ç‰¹æŒ‡[`docs\æ–°è¯¾ä»¶æç¤ºè¯\ç”Ÿæˆschema.md`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/docs/%E6%96%B0%E8%AF%BE%E4%BB%B6%E6%8F%90%E7%A4%BA%E8%AF%8D/%E7%94%9F%E6%88%90schema.md)ï¼‰å°±åƒå†™ä»£ç ä¸€æ ·ï¼Œä¸å¤ªå¯èƒ½ä¸€æ¬¡æ€§å°±è€ƒè™‘åˆ°æ‰€æœ‰çš„ç»†èŠ‚ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®LLMçš„åé¦ˆï¼Œå°¤å…¶æ˜¯åœ¨â€œæ·±åº¦æ€è€ƒâ€è¿‡ç¨‹ä¸­çš„åé¦ˆï¼Œä¼˜åŒ–è‡ªå·±çš„æ¨¡æ¿æç¤ºè¯ã€‚æ¯”å¦‚ï¼š

ä¸€ã€æˆ‘åœ¨ç”Ÿæˆã€Šå‡½æ•°åŠå…¶è¡¨ç¤ºæ–¹æ³•ã€‹è¯¾ä»¶æ—¶ï¼Œçœ‹åˆ°DeepSeekåœ¨æ·±åº¦æ€è€ƒä¸­è¾“å‡ºï¼šâ€œæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­åªéœ€è¦æŒ‰ç…§è§„èŒƒå†™ç±»åï¼Œæ¯”å¦‚`<h4 className={styles.teachingPlanH4}>`ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬æ— æ³•è·å–stylesï¼Œæ‰€ä»¥å®é™…ä¸Šä¸»ç»„ä»¶ä¼šå¤„ç†æ ·å¼ç±»ã€‚ä½†æ˜¯ï¼Œä¸ºäº†ç±»å‹æ­£ç¡®ï¼Œæˆ‘ä»¬æŒ‰ç…§è§„èŒƒå†™ç±»åå­—ç¬¦ä¸²ï¼Ÿä¸ï¼Œè¿™æ ·ä¸è¡Œã€‚å› ä¸ºstylesæ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ä¸ä¸»ç»„ä»¶ç›¸åŒçš„æ ·å¼æ¨¡å—ã€‚ä½†é…ç½®æ–‡ä»¶æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥ä¸»ç»„ä»¶åœ¨æ¸²æŸ“æ—¶ä¼šä¼ å…¥stylesã€‚ï¼ˆçœç•¥æ›´å¤šåºŸè¯ï¼‰â€å°±ç«‹åˆ»æ„è¯†åˆ°æˆ‘å¿˜è®°import stylesäº†ï¼Œè€ŒDeepSeekèƒ½åŠ›å¤ªå·®ï¼Œæ¨ä¸å‡ºå®é™…æƒ…å†µï¼Œéœ€è¦è¡¥å……ï¼š

```jsx
import styles from '@/component/teachingPlan/basic.module.scss'; // è¡¥ä¸Š
<h4 className={styles.teachingPlanH4}></h4>
<h5 className={styles.teachingPlanH5}></h5>
<h6 className={styles.teachingPlanH6}></h6>
```

äºŒã€å‘ç°DeepSeekæ²¡æœ‰è¾“å‡º`appletOnLoad`å‡½æ•°ã€‚ä¸€å¼€å§‹æœ‰ç‚¹æ¼ç«ï¼Œä½†åæ¥æ³¨æ„åˆ°ï¼ŒDeepSeekåœ¨æ·±åº¦æ€è€ƒä¸­è¾“å‡ºï¼šâ€œå…·ä½“çš„ç»˜åˆ¶å‘½ä»¤åœ¨appletOnLoadä¸­ï¼Œä½†è¿™é‡Œæˆ‘ä»¬åªå†™å‘½ä»¤å­—ç¬¦ä¸²ï¼Œå› ä¸ºé…ç½®å¯¹è±¡ä¸­çš„å‡½æ•°æ— æ³•åºåˆ—åŒ–ï¼Œæ‰€ä»¥å®é™…ä¸Šåœ¨GeogebraItemä¸­ï¼Œconfigæ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼Œè€Œç»˜åˆ¶å‘½ä»¤æˆ‘ä»¬å°†åœ¨æè¿°ä¸­è¯´æ˜ï¼Œæˆ–è€…åœ¨conclusionä¸­åˆ†æã€‚â€

åæ¥æˆ‘ä»¬åœ¨`docs\Geogebraç»„ä»¶æ–‡æ¡£.md`ä¸­è¡¥å……äº†â€œå¦‚ä½•åœ¨JS Configä¸­ä½¿ç”¨â€ä¸€èŠ‚ï¼Œå®ƒä¹Ÿå°±çŸ¥é“å¦‚ä½•å®ç°`appletOnLoad`æ–¹æ³•äº†ã€‚

## ã€å¸¸è§„ã€‘æ”¯æŒè·¯ç”±

æˆ‘æœ‰ä¸æ­¢ä¸€ä¸ªè¯¾ä»¶ï¼Œæ‰€ä»¥è¿™ä¸ªé¡¹ç›®è‡ªç„¶è¦æ”¯æŒè·¯ç”±ã€‚æ”¯æŒè·¯ç”±æŒºå¸¸è§„çš„ï¼Œè·Ÿå¾€å¸¸ä¸€æ ·`bun add react-router-dom`å³å¯ã€‚ä¸»è¦éœ€è¦æ³¨æ„æ”¹ä¸€ä¸‹è¿™å¥`k = e('/geogebra/web3d/');`ï¼ˆè¯¦è§ã€Šgeogebraçš„è‡ªæ‰˜ç®¡è§£å†³æ–¹æ¡ˆã€‹ä¸€èŠ‚ï¼‰ã€‚`src\App.jsx`ï¼š

```jsx
import { BrowserRouter as Router, Routes, Route } from 'react-router-dom';
import { HelmetProvider } from 'react-helmet-async';

const routes = [
  { path: '/', element: <TeachingPlanList /> },
  { path: '/plane-vector-definition', element: <PlaneVectorDefinition /> },
  // ...
  { path: '/404', element: <NotFound /> },
  { path: '*', element: <NotFound /> },
];

function App() {
  return (
    <HelmetProvider>
      <Router>
        <Layout>
          <Routes>
            {
              routes.map((route, index) => (
                <Route
                  key={route.path || `route-${index}`}
                  path={route.path}
                  element={route.element}
                />
              ))
            }
          </Routes>
        </Layout>
      </Router>
    </HelmetProvider>
  );
}
```



## ã€å¸¸è§„ã€‘AIç”Ÿæˆæ•™æ¡ˆç½‘é¡µåœºæ™¯ä¸‹å¦‚ä½•è§£å†³æ ·å¼å†²çª

æˆ‘ä»¬å…ˆç”Ÿæˆç¬¬ä¸€ä¸ªæ•™æ¡ˆç½‘é¡µï¼Œç„¶åç ”ç©¶å¦‚ä½•ç”Ÿæˆå…¶ä»–æ•™æ¡ˆç½‘é¡µã€‚è¿™å°±æœ‰ä¸€ä¸ªç»•ä¸è¿‡å»çš„é—®é¢˜ï¼šå¦‚ä½•è§£å†³æ ·å¼å†²çªï¼Ÿæˆ‘æƒ³åˆ°ä¸¤æ¡è·¯ï¼š

1. å°½é‡å°‘æ›´æ”¹AIç”Ÿæˆçš„ç¬¬ä¸€ä¸ªæ•™æ¡ˆç½‘é¡µï¼Œå°†å…¶æ”¾å…¥shadow domã€‚æˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ä¸»è¦çš„å›°éš¾åœ¨äºgeogebraã€‚è¿™æ¡è·¯ä¹Ÿè®¸èƒ½èµ°é€šï¼Œä½†é£é™©å¤ªé«˜ï¼Œ**èˆå¼ƒ**ã€‚
    1. å®ƒçš„æºç å¼•ç”¨äº†`document.getElementByIdã€document.querySelector`ç­‰æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•éƒ½ä¼šå¤±æ•ˆã€‚è¿™ä¸ªæ˜¯å¯è§£çš„ï¼Œhookå®ƒä»¬å°±è¡Œã€‚
    2. geogebraå¼•å…¥äº†5ä¸ªCSSæ–‡ä»¶ï¼ˆå¯ä»¥ç”¨`document.querySelectorAll('link.ggw_resource')`æ‹¿åˆ°ï¼‰ã€‚å®ƒä»¬æ— æ³•ä½œç”¨åˆ°shadow domå†…éƒ¨ã€‚è¿™ä¸ªä¹Ÿå¥½å¤„ç†ï¼Œå†™æ®µJSæ‰‹åŠ¨æŠŠå®ƒä»¬æ’å…¥åˆ°shadow domé‡Œå³å¯ã€‚
    3. å¤„ç†ä¸Šé¢ä¸¤ç‚¹äº†ï¼Œå°±ä¸å†æœ‰å¤§é”™è¯¯äº†ï¼Œä½†è¿˜æœ‰ä¸€äº›éšè”½çš„æŠ¥é”™ã€‚æ¯”å¦‚ï¼š`:root`æŒ‡å®šçš„CSSå˜é‡æ— æ³•å¼•ç”¨åˆ°ï¼Œå¯¼è‡´è®¾ç½®åæ ‡è½´é¢œè‰²çš„OKæŒ‰é’®å¤±å»èƒŒæ™¯è‰²ã€‚ä¿®æ”¹`geogebra/css/bundles/bundle.css`çš„`:root`ä¸º`:root, :host`å¯è§£å†³ã€‚
    4. ç­‰å¼æ çš„æ¯ä¸ªæ¡ç›®å·¦ä¸Šè§’çš„ä¸‰ä¸ªç‚¹ç‚¹å‡»ä¸¤æ¬¡æ‰èƒ½å‡ºç°èœå•æ ã€‚è¿™ä¸ªç¡®å®ä¸æ‡‚æ€ä¹ˆè§£äº†ã€‚
2. å¼•å…¥scsså’Œcss modulesã€‚æ‰‹åŠ¨æˆ–è€…è®©AIæ”¹å¥½ç¬¬ä¸€ä¸ªæ•™æ¡ˆç½‘é¡µã€‚ç„¶åç”¨ç¬¬ä¸€ä¸ªæ•™æ¡ˆç½‘é¡µçš„ä»£ç ç”Ÿæˆå¼€å‘è§„èŒƒï¼Œåœ¨åç»­ç”Ÿæˆå…¶ä»–æ•™æ¡ˆç½‘é¡µæ—¶å°†å¼€å‘è§„èŒƒä¸€èµ·è¾“å…¥åˆ°æç¤ºè¯é‡Œã€‚æœ€åæˆ‘**é€‰æ‹©**äº†è¿™æ¡è·¯ã€‚

é™„ï¼šå¦‚ä½•hook `document.getElementById`ï¼š

```js
export function getShadowRootWrap() {
  return document.querySelector('.shadow-root-div')?.shadowRoot;
}

const settings = {
  showLog: false,
};

export function hookGetEleById() {
  settings.showLog && console.log('%c[teaching-plan-analytic-geometry] æ­£åœ¨ hook document.getElementById', 'background: #3a2e00; color: #e2c041; padding: 3px 6px;');
  const originalGetEleById = document.getElementById;
  document.getElementById = function (id) {
    settings.showLog && console.log('[teaching-plan-analytic-geometry] document.getElementById matched param', id);
    const shadowRootWrap = getShadowRootWrap();
    if (!shadowRootWrap) {
      return originalGetEleById.call(document, id);
    }
    const res = shadowRootWrap?.querySelector(`#${id}`);
    return res || null;
  };
}
```

## ã€å¸¸è§„ã€‘æ¥å…¥`shadcn-ui`ç»„ä»¶åº“

æˆ‘å‘ç°è¿™ä¸ªé¡¹ç›®è¿˜æ˜¯éœ€è¦ä¸€äº›è¡¨å•ç»„ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘å†³å®šæ¥å…¥`shadcn-ui`ç»„ä»¶åº“ã€‚æˆ‘ä»¬å·²ç»é…è¿‡Tailwind CSSäº†ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œæ¥ä¸‹æ¥å¤§è‡´è¦åšï¼š

- å¼•å…¥shadcnç”¨åˆ°çš„å‡ åä¸ªCSSå˜é‡
- å¼•å…¥`jsconfig.json`
- æ–°å»º`components.json`

å¼•å…¥CSSå˜é‡ï¼šæˆ‘ä»¬ä¸å¦¨å» https://tweakcn.com/editor/theme ç›´æ¥æ‹¿å¥½çœ‹çš„ä¸»é¢˜ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯`modern-minimal`ï¼Œç›®å‰å’Œæˆ‘é¡¹ç›®çš„è“è‰²ä¸»é¢˜æ¯”è¾ƒé…ã€‚

`components.json`ä¸éœ€è¦ç‰¹åˆ«é…ç½®ï¼Œç›´æ¥ä»å®˜æ–¹æ–‡æ¡£å¤åˆ¶ç²˜è´´ï¼Œæ”¹ä¸‹`css`å’Œ`components`å±æ€§å°±è¡Œã€‚

`jsconfig.json`å¯ä»¥ç†è§£ä¸º`tsconfig.json`åœ¨æ— TSçš„å¼€å‘ç¯å¢ƒçš„ç®€åŒ–ç‰ˆï¼Œå¯ä»¥æ–¹ä¾¿IDEå®ç°æ™ºèƒ½è¡¥å…¨ç­‰ç‰¹æ€§ï¼Œä½†shadcnçš„CLIä¹Ÿä¼šç”¨åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸é…ç½®ä¸€ä¸‹ã€‚

```json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": [
        "src/*"
      ]
    }
  },
  "exclude": [
    "node_modules",
    "dist"
  ],
  "include": [
    "src/**/*",
    "tests/**/*"
  ]
}
```

æ¥ä¸‹æ¥å¯ä»¥ç›´æ¥å°è¯•ä¸‹è½½ 21st.dev è¿™ä¸ªç½‘ç«™æä¾›çš„ä¸€äº›å¥½çœ‹çš„ç»„ä»¶ï¼š`bunx --bun shadcn@latest add "https://21st.dev/r/originui/numbered-pagination"`ã€‚

## ã€å¸¸è§„ã€‘`Think`ç»„ä»¶

æ•ˆæœï¼š

![4-Thinkç»„ä»¶æ•ˆæœ.png](./README_assets/4-Thinkç»„ä»¶æ•ˆæœ.png)

è¿™ä¸ªç»„ä»¶å”¯ä¸€å€¼å¾—è¯´çš„å°±æ˜¯å¦‚ä½•å®ç°å±•å¼€/æ”¶èµ·çš„è¿‡æ¸¡åŠ¨ç”»ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªå˜é‡è®°å½•æ˜¯å¦å±•å¼€ï¼š`const [isOpen, setIsOpen] = useState(false);`ï¼Œç„¶åç”¨CSS transitionæˆ–è€…`framer-motion`æ§åˆ¶`max-height`çš„å¢å‡ã€‚

```jsx
<motion.div
  className={styles.answerRow}
  initial={{ maxHeight: 0, marginTop: '0' }}
  animate={{
    maxHeight: isOpen ? answerRowMaxHeight || '100px' : 0,
    marginTop: isOpen ? '8px' : '0',
  }}
  transition={{ duration: 0.3 }}
>
  <MarkdownRenderer content={answer} />
</motion.div>
```

æˆ‘ä»¬å¿…é¡»è¦æŒ‡å®šä¸€ä¸ªå…·ä½“çš„`max-height`ï¼Œå¦åˆ™ä¸ä¼šæœ‰åŠ¨ç”»ã€‚å› æ­¤æˆ‘é€‰æ‹©è®©å¤–ç•Œä¼ å…¥è¿™ä¸ªå±æ€§ï¼Œç„¶åæ‰‹å·¥è°ƒæ•´ã€‚

å¦å¤–ï¼Œä¸Šé¢è®¾ç½®çš„`marginTop`æ˜¯ä¸ºäº†ç…§é¡¾é—®é¢˜å’Œç­”æ¡ˆä¹‹é—´çš„åˆ†å‰²çº¿ã€‚

## ã€å›°éš¾ã€‘Markdown ä»£ç å—äº¤äº’å‡çº§ï¼šå±•ç¤ºè¡Œå·ã€æ”¯æŒå±•å¼€ä»£ç å—ã€å¤åˆ¶ä»£ç ã€ä¸‹è½½ä»£ç 

å‘œå‘œå‘œï¼Œæˆ‘ç¡®å®åæ‚”æ²¡æœ‰åšè¶³å¤Ÿå¤šæŠ€æœ¯è°ƒç ”ï¼Œä¸€ç›´æ²¡å‘ç°æœ‰`react-markdown`è¿™ä¸ªåŒ…ï¼Œæ‰€ä»¥ç°åœ¨ä¹Ÿåªèƒ½å°†å°±ç”¨markedæ¸²æŸ“Markdownã€‚

æ•ˆæœï¼š

![2-å¢å¼ºçš„Markdownä»£ç å—æ•ˆæœå±•ç¤º.png](./README_assets/2-å¢å¼ºçš„Markdownä»£ç å—æ•ˆæœå±•ç¤º.png)

å¦‚æœåªä½¿ç”¨`marked-highlight`æ’ä»¶ï¼Œæ‹¿åˆ°çš„ä»£ç å—å°±åªå±•ç¤ºäº†ä»£ç å—ã€‚ä½†æˆ‘ä»¬çœ‹DeepSeekå®˜ç½‘ç­‰äººä»¬ç†Ÿæ‚‰çš„é¡µé¢ï¼Œé‡Œé¢çš„ä»£ç å—éƒ½æœ‰è¡Œå·ï¼Œæ”¯æŒå¤åˆ¶ï¼Œæ”¯æŒå±•å¼€ä»£ç ç­‰åŠŸèƒ½ã€‚æˆ‘é—®LLMä»¥åŠåœ¨äº’è”ç½‘ä¸Šæœï¼Œéƒ½æ²¡æœ‰æœåˆ°ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘è®¤å®šè¿™æ˜¯è¦å¤æ³•æ‰‹ä½œç¼–ç¨‹çš„ã€‚ç½‘ä¸Šå†²æµªä¸€å°ä¼šä»¥åï¼Œæˆ‘è§‰å¾—æ˜é‡‘çš„â€œå±•å¼€ä»£ç å—â€çš„è®¾è®¡å’Œ`vitepress`çš„å¤åˆ¶æŒ‰é’®çš„ç‚¹å‡»æ•ˆæœä¸é”™ï¼Œå› æ­¤å†³å®šæŠŠå®ƒä»¬æŠ„è¿‡æ¥ã€‚

### ã€å›°éš¾ã€‘ä¸å¾—ä¸åœ¨Reactä¸­å†™åŸç”ŸHTMLä»£ç 

æˆ‘ç¿»äº†`marked-highlight`çš„æºç ï¼Œå‘ç°å®ƒæä¾›çš„è‡ªå®šä¹‰èƒ½åŠ›å¤ªå¼±äº†ï¼Œæ‰€ä»¥æˆ‘å†³å®šæŠ›å¼ƒ`marked-highlight`ï¼Œè‡ªå®šä¹‰rendererå®ç°ï¼ˆè¿™å…¶å®ä¹Ÿæ˜¯marked-highlightçš„å®ç°æ–¹å¼ï¼‰ã€‚æˆ‘ä»¬ä¸å¦¨æŠŠç›¸å…³é€»è¾‘å•ç‹¬æå–å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œäºæ˜¯æœ‰äº†[`src\lib\hljsRenderer.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/lib/hljsRenderer.js)ï¼š

```js
import hljs from 'highlight.js';

function getLineNumbersHtml(lineLength) {
  const lineNumbersCode = [...Array(lineLength)]
    .map(
      (_, index) =>
        `<span class="line-number">${index + 1}</span><br>`
    )
    .join('');

  const lineNumbersWrapperCode = `<div class="line-numbers-wrapper" aria-hidden="true">${lineNumbersCode}</div>`;
  return lineNumbersWrapperCode;
}

export default {
  code({ lang, text: code }) {
    const language = hljs.getLanguage(lang) ? lang : 'plaintext';
    const highlighted = hljs.highlight(code, { language }).value;

    const dataCode = encodeURI(code);

    const lineLength = code.split('\n').length;
    const lineNumbersHtml = getLineNumbersHtml(lineLength);

    return `
<div class="code-block-wrapper" data-language="${language}" data-line-count="${lineLength}">
  <div class="code-header">
    <div class="header-left-part">
      <div class="svg-chevron-down-wrapper" title="å±•å¼€ä»£ç å—"></div>
      <span class="language-tag">${language}</span>
    </div>
    <div class="header-right-part">
      <button title="å¤åˆ¶ä»£ç " class="copy-button" data-code="${dataCode}"></button>
      <div class="svg-download-wrapper" title="ä¸‹è½½ä»£ç "></div>
    </div>
  </div>
  <div class="code-body">
    ${lineNumbersHtml}
    <pre class="code-pre"><code class="highlighted-code hljs language-${language}">${highlighted}</code></pre>
  </div>
</div>`.trim();
  },
};
```

åœ¨rendereré‡Œæ‹¼æ¥ä¸€å¤§æ®µHTMLç¡®å®æŒºéš¾ç»·çš„ï¼Œè€Œä¸”æœ‰XSSé£é™©ï¼Œä½†æˆ‘ç¡®å®æ²¡æ‰¾åˆ°èƒ½åœ¨Reactä¸­ä¼˜é›…åœ°å®Œæˆè¿™ä»¶äº‹çš„æ–¹æ¡ˆã€‚å¯ä»¥çœ‹åˆ°æˆ‘åœ¨ä¸Šé¢è®¾ç½®äº†ä¸€ä¸ªç•™ç©ºçš„`svg-chevron-down-wrapper`ï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿JSæ’å…¥â€œå±•å¼€ä»£ç å—â€çš„svgå›¾æ ‡ã€‚

1. ä¸ºäº†ç»™è¿™äº›HTMLä»£ç åŠ ä¸ŠCSSï¼Œæˆ‘å†™äº†[`src\styles\code-block.scss`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/styles/code-block.scss)ï¼Œä¾›å…¥å£`main.jsx`è°ƒç”¨ã€‚
2. ä¸ºäº†å®ç°å¤åˆ¶ä»£ç ç­‰åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å†™å¤§æ®µå¤§æ®µçš„åŸç”ŸJSã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªè‡ªå®šä¹‰hookï¼ˆ[`src\hooks\useCodeBlockSetup.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/hooks/useCodeBlockSetup.js)ï¼‰ï¼Œä¾›`MarkdownRenderer`ç»„ä»¶è°ƒç”¨ã€‚

### `src\hooks\useCodeBlockSetup.js`çš„å¤§è‡´æ¡†æ¶

```js
import { useEffect, useRef } from 'react';
import ChevronDown from '@/assets/fa-chevron-down.svg';
import { CODE_BODY_INITIAL_MAX_HEIGHT } from '@/common/consts';

export default function useCodeBlockSetup() {
  const tpmMdContainerRef = useRef(null);

  useEffect(() => {
    const codeBlockWrapperSetup = () => {
      tpmMdContainerRef.current?.querySelectorAll('.code-block-wrapper')?.forEach((codeBlockWrapper) => {
        // è®¾ç½® code-block-wrapper çš„æ ·å¼
      });

      tpmMdContainerRef.current?.querySelectorAll('.code-block-wrapper .svg-chevron-down-wrapper')?.forEach((svgChevronDownWrapper) => {
        if (svgChevronDownWrapper.children.length) {
          return;
        }
        // æ’å…¥å±•å¼€ä»£ç å—çš„ svg å›¾æ ‡ã€æ³¨å†Œç‚¹å‡»äº‹ä»¶
      });

      tpmMdContainerRef.current?.querySelectorAll('.code-block-wrapper .copy-button')?.forEach((button) => {
        // æ³¨å†Œç‚¹å‡»äº‹ä»¶
      });
    };

    codeBlockWrapperSetup();

    const setupObserver = new MutationObserver(codeBlockWrapperSetup);
    tpmMdContainerRef.current && setupObserver.observe(tpmMdContainerRef.current, {
      subtree: true,
      childList: true,
    });

    return () => {
      setupObserver.disconnect();
    };
  }, []);

  return tpmMdContainerRef;
}
```

åœ¨`useEffect`é‡Œç”¨`MutationObserver`æ˜¯åŸºç¡€æ“ä½œäº†ï¼Œè€Œå¯¹`tpmMdContainerRef.current`çš„æ“ä½œå°±æ˜¯åœ¨ç®¡ç†ä¸€ä¸ª`Markdown`å—ä¸‹æ‰€æœ‰çš„`code-block-wrapper`ã€‚

`MarkdownRenderer`è°ƒç”¨ï¼š

```jsx
const tpmMdContainerRef = useCodeBlockSetup();
<div ref={tpmMdContainerRef} />
```



### ã€å¸¸è§„ã€‘è®©`code-block-wrapper`çš„æ ·å¼ä¸ä»£ç å—ä¿æŒä¸€è‡´

250811æ›´æ–°ï¼šè¯¥æ–¹æ¡ˆå·²è¢«åºŸå¼ƒï¼Œè¯·å‚è€ƒã€Šç¼–å†™ postcss æ’ä»¶ï¼šå¦‚ä½•åœ¨ marked + highlight.js ä¸­å®ç°åˆ‡æ¢ä»£ç å—é£æ ¼ã€‹ã€‚

æˆ‘ä¹‹å‰å¼•ç”¨äº†`paraiso-light`ä¸»é¢˜ï¼Œè¿™ä¸ªä¸»é¢˜ä¼šè®¾ç½®ä»£ç å—çš„èƒŒæ™¯è‰²å’Œé»˜è®¤æ–‡å­—é¢œè‰²ï¼Œæ‰€ä»¥æˆ‘çš„`code-block-wrapper`éœ€è¦æ‹¿åˆ°è¿™ä¸ªä¸»é¢˜è®¾ç½®ä»¥åçš„CSSã€‚è¿™ä¸ªæ´»æˆ‘è®¤ä¸ºåªèƒ½ç”¨JSå®ç°ã€‚

```js
const codeNode = codeBlockWrapper.querySelector('.highlighted-code');
const codeNodeComputedStyle = getComputedStyle(codeNode, null);
const codeNodeBgColor = codeNodeComputedStyle.getPropertyValue('background-color');
const codeNodeColor = codeNodeComputedStyle.getPropertyValue('color');
codeBlockWrapper.style.backgroundColor = codeNodeBgColor;
codeBlockWrapper.style.color = codeNodeColor;
```



### ã€å¸¸è§„ã€‘å±•å¼€ã€æ”¶èµ·ä»£ç å—æ”¯æŒè¿‡æ¸¡åŠ¨ç”»

è¿™ä¸ªå¯ä»¥ç›´æ¥æŒªç”¨æˆ‘ä¹‹å‰çš„[Thinkç»„ä»¶](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/teachingPlan/Think.jsx)çš„å®ç°æ–¹æ¡ˆã€‚æˆ‘ä»¬è®©DeepSeekæŠŠmotionè½¬ä¸ºåŸç”ŸCSSï¼š

```markdown
å¤§ä½¬ï¼Œä½ æ˜¯ä¸€åä¸“å®¶å‰ç«¯å·¥ç¨‹å¸ˆï¼Œç²¾é€šå‰ç«¯å·¥ç¨‹åŒ–ã€‚è¯·å«æˆ‘hans7ã€‚æˆ‘æœ‰ä¸€ä¸ªreact + framer-motioné¡¹ç›®ï¼Œæœ‰å¦‚ä¸‹ä»£ç ï¼š
è¯·å¿½ç•¥å…¶ä»–ä»£ç ï¼Œå°†motion.spanå’Œmotion.divçš„initialã€animateã€transitionå±æ€§ç¿»è¯‘ä¸ºcssä»£ç ï¼Œç±»ååˆ†åˆ«å«.spanå’Œ.divã€‚
```

[`src\styles\code-block.scss`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/styles/code-block.scss)ç›¸å…³ä»£ç å¤§è‡´å¦‚ä¸‹ï¼š

```scss
.code-body {
  // ...
  transition: max-height 0.3s ease;
  max-height: var(--code-body-initial-max-height);

  .line-numbers-wrapper {
    // ...
  }

  .code-pre {
    flex: 1;
    overflow-x: auto;

    .highlighted-code {
      max-height: var(--code-body-initial-max-height);
      // pre code.hljs å·²ç»è®¾ç½® overflow-x ï¼Œåœ¨æ­¤æŠŠ x å’Œ y çš„éƒ½å†™ä¸Šäº†
      overflow-x: auto;
      overflow-y: hidden;
    }
  }
}
```

ç„¶ååœ¨JSä¸­ï¼ˆ[`src\hooks\useCodeBlockSetup.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/hooks/useCodeBlockSetup.js)ï¼‰ï¼š

```js
const img = document.createElement('img');
img.classList.add('svg-chevron-down-wrapper-img');
img.src = ChevronDown;
img.addEventListener('click', () => {
  const hasExpanded = img.classList.contains('expanded');
  img.classList.toggle('expanded');

  svgChevronDownWrapper.title = hasExpanded ? 'å±•å¼€ä»£ç å—' : 'æ”¶èµ·ä»£ç å—';
  const codeBody = targetCodeBlockWrapper.querySelector('.code-body');
  if (!codeBody) return;
  // æ¯è¡Œå…¶å®ä¸åˆ° 28px ï¼Œä½†è®¾ç½®è¿™ä¸ªç¨å¤§çš„æ•°å¹¶ä¸å¤ªå½±å“åŠ¨ç”»æ•ˆæœ
  const maxHeight = hasExpanded ? CODE_BODY_INITIAL_MAX_HEIGHT : (28 + targetCodeBlockWrapper.dataset.lineCount * 28);
  codeBody.classList.toggle('expanded');
  codeBody.style.maxHeight = `${maxHeight}px`;

  const codeNode = codeBody.querySelector('.highlighted-code');
  if (!codeNode) return;
  codeNode.style.maxHeight = `${maxHeight}px`;
});
svgChevronDownWrapper.appendChild(img);
```

### ã€å¸¸è§„ã€‘å¤åˆ¶æŒ‰é’®

ä¸ºäº†å‡è½»å·¥ä½œé‡ï¼Œæˆ‘å†³å®š~~æŠ„è¢­~~å‚è€ƒvitepressçš„æºç ã€‚ç»“åˆvitepressæ¸²æŸ“å‡ºçš„HTMLï¼Œä¸éš¾å®šä½åˆ°å¤åˆ¶æŒ‰é’®çš„HTMLä½äº[`src\node\markdown\plugins\preWrapper.ts`](https://github.com/vuejs/vitepress/blob/db58af5c66e563e7663084057a9853d8f2da984c/src/node/markdown/plugins/preWrapper.ts)ï¼Œæœcopiedç±»åï¼Œä¸éš¾å®šä½åˆ°å…¶CSSä½äº[`src\client\theme-default\styles\components\vp-doc.css`](https://github.com/vuejs/vitepress/blob/a64334753079a5b874a482508d9ee255d2a0ea38/src/client/theme-default/styles/components/vp-doc.css)ã€‚

å¤åˆ¶æŒ‰é’®çš„æ ·å¼ï¼š

```scss
.copy-button {
  // é»˜è®¤çš„ svg
  background-image: url("svg1");

  &.copied {
    /*rtl:ignore*/
    // å¤åˆ¶æˆåŠŸçš„ svg
    background-image: url("svg2");
  }

  // å¤åˆ¶æˆåŠŸæ—¶ï¼Œå±•ç¤ºâ€œå·²å¤åˆ¶â€æ–‡å­—
  &.copied::before {
    content: 'å·²å¤åˆ¶';
  }
}
```

ä¸ºäº†æ‹¿åˆ°åŸæ±åŸå‘³çš„ä»£ç ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥å–`code`æ ‡ç­¾çš„`innerText`ï¼Œè€Œæ˜¯ç»™buttonæ·»åŠ ä¸€ä¸ª`data-code`å±æ€§ã€‚æ‰€ä»¥ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š

```js
button.addEventListener('click', () => {
  const code = decodeURI(button.dataset.code);
  navigator.clipboard.writeText(code);
  button.classList.add('copied');
  // æ¨¡ä»¿ vitepress 2s åç”±â€œå·²å¤åˆ¶â€æ¢å¤åŸçŠ¶
  setTimeout(() => button.classList.remove('copied'), 2000);
});
```

### ã€å¸¸è§„ã€‘ä¸‹è½½ä»£ç 

æˆ‘ä»¬å‘ç° [DeepSeekå®˜ç½‘](https://chat.deepseek.com/) çš„Markdownä»£ç å—æœ‰ä¸€ä¸ªâ€œä¸‹è½½â€æŒ‰é’®ï¼Œæˆ‘ä»¬ä¸å¦¨ä¹Ÿå®ç°ä¸€ä¸ªã€‚[`src\hooks\useCodeBlockSetup.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/hooks/useCodeBlockSetup.js)ï¼š

```js
tpmMdContainerRef.current?.querySelectorAll('.code-block-wrapper')?.forEach((codeBlockWrapper) => {
  const downloadWrapper = codeBlockWrapper.querySelector('.svg-download-wrapper');
  if (downloadWrapper.children.length) {
    return;
  }

  const img = document.createElement('img');
  img.classList.add('svg-download-wrapper-img');
  img.src = DownloadSvg;
  img.addEventListener('click', () => {
    downloadCode(codeBlockWrapper);
  });
  downloadWrapper.appendChild(img);
});
```

`downloadCode`å‡½æ•°æŠŠå­—ç¬¦ä¸²è£…è¿›`Blob`é‡Œï¼Œç„¶ååˆ›å»º`a`æ ‡ç­¾ã€è®¾ç½®`download`å±æ€§ï¼Œå±äºæ¨¡æ¿äº†ï¼Œå·²ç»åˆ»åœ¨æ¯ä¸€ä½å‰ç«¯å·¥ç¨‹å¸ˆçš„DNAé‡Œã€‚

```js
function downloadCode(codeBlockWrapper) {
  const copyBtn = codeBlockWrapper.querySelector('.copy-button');
  if (!copyBtn) {
    console.error('[tpm] failed to find .copy-button');
    return;
  }
  const language = codeBlockWrapper.dataset.language;
  const extName = hljsLangToExtName(language);
  const code = decodeURI(copyBtn.dataset.code);
  const blob = new Blob([code], { type: 'text/plain' });
  const downloadUrl = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = downloadUrl;
  a.download = `tpm-${document.title}.${extName}`;
  document.body.appendChild(a);
  a.click();
  setTimeout(() => {
    document.body.removeChild(a);
    URL.revokeObjectURL(downloadUrl);
    toast.success('ä¸‹è½½æˆåŠŸï¼');
  }, 100);
}
```

è¿™é‡Œç”¨åˆ°`sonner`åŒ…çš„`toast`å®ç°æ¶ˆæ¯æç¤ºï¼Œä»¥åŠ`hljsLangToExtName`å‡½æ•°è·å–æ­£ç¡®çš„æ–‡ä»¶åç¼€åï¼Œæˆ‘å°†åœ¨ä¸‹é¢ä¸¤ä¸ªå°èŠ‚åˆ†åˆ«ç»†è®²ã€‚

### ã€å¸¸è§„ã€‘`sonner`åŒ…é…ç½®

æŸ¥[`sonner`å®˜æ–¹æ–‡æ¡£](https://sonner.emilkowal.ski/styling)å¯çŸ¥ï¼Œå¯ä»¥ç”¨`style`é…å¤–å±‚ç›’å­çš„æ ·å¼ï¼Œç”¨`classNames`å†™Tailwind CSSå¯ä»¥é…ç½®é‡Œé¢å„ä¸ªUIå…ƒç´ çš„æ ·å¼ã€‚

```jsx
<Toaster
  position='top-center'
  toastOptions={{
    style: {
      color: 'white',
      backgroundColor: 'var(--vivid-blue-bg)',
      borderColor: '#4cc9f0',
    },
    classNames: {
      title: '!font-(family-name:--tpm-font-family) !font-bold !text-base',
    },
  }}
/>
```

Tailwindå¯ä»¥å¼•ç”¨CSSå˜é‡ï¼Œåœ¨`src\index.css`é…ä¸€ä¸‹å°±è¡Œã€‚

### ã€ç®€å•ã€‘`hljsLangToExtName`å‡½æ•°ï¼šå°†`highlight.js`çš„`language`ä¿¡æ¯è½¬ä¸ºæ°å½“çš„æ–‡ä»¶åç¼€å

DeepSeekç»™äº†æˆ‘ä¸¤ä¸ªæ–¹æ¡ˆï¼š

- [language-map](https://github.com/blakeembrey/language-map)
- [mime-types](https://github.com/jshttp/mime-types)

å‰è€…ä¸ç¬¦åˆæˆ‘éœ€æ±‚ï¼Œåè€…OKã€‚[`src\lib\hljsLangToExtName.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/lib/hljsLangToExtName.js)ï¼š

```js
import mimeTypes from 'mime-types';

export default function hljsLangToExtName(language) {
  const contentType = mimeTypes.lookup(language) || 'txt';
  const extName = mimeTypes.extension(contentType) || 'txt';
  return extName;
}
```

ç›´æ¥è¿è¡Œä¼šé‡åˆ°æŠ¥é”™ï¼š`extname`æœªå®šä¹‰ã€‚ç¨å¾®çŸä¸€çœ¼æºç ï¼Œä¸éš¾å‘ç°æ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ç¯å¢ƒå¼•ç”¨äº†nodeç¯å¢ƒçš„`path`åŒ…ã€‚`bun add -D vite-ping-plan-analytic-geometry`ï¼Œç„¶åé…ç½®ä¸€ä¸‹`polyfill`å³å¯ï¼š

```js
import { nodePolyfills } from 'vite-plugin-node-polyfills';

plugins: [
  nodePolyfills(),
]
```

### ã€å¸¸è§„ã€‘å¼•å…¥`@tailwindcss/typography`ï¼Œä¸€é”®ç¾åŒ–å·²æ¸²æŸ“ä¸ºHTMLçš„åšå®¢

ç…§å®˜æ–¹æ–‡æ¡£è¯´çš„åšå°±èƒ½è½»æ¾å¼•å…¥ï¼š

```css
/* src\index.css */
@plugin "@tailwindcss/typography";
```

ç„¶ååœ¨`src\component\MarkdownRenderer.jsx`é‡Œæ–°å¢ç±»å`prose dark:prose-invert`å³å¯ã€‚ä½†æˆ‘å¸Œæœ›è‡ªå®šä¹‰Markdown HTMLä¸­çš„ä¸€äº›å…ƒç´ ï¼Œæ¯”å¦‚`blockquote`ã€‚å®Œæˆè¿™ä¸ªéœ€æ±‚æœ€ç®€å•çš„åšæ³•æ˜¯ç›´æ¥æ–°å¼€ä¸€ä¸ªcssæ–‡ä»¶ï¼Œæ­£å¸¸ä¹¦å†™ï¼Œè¦†ç›–typographyçš„é»˜è®¤æ ·å¼ã€‚[`src\styles\prose-overwrite.scss`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/styles/prose-overwrite.scss)ï¼š

```scss
.prose {
  blockquote {
    background-color: var(--blockquote-bg);
    overflow: auto;

    p {
      margin: 10px 0;
    }
  }
  // ...
}
```

ä¸ºäº†æ–¹ä¾¿åœ°æ›´æ”¹`blockquote`çš„å·¦è¾¹æ¡†é¢œè‰²å’ŒèƒŒæ™¯è‰²ï¼Œæˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ª`tailwind.config.js`ï¼Œè¦†ç›–`typography`å†…ç½®çš„å˜é‡å€¼ã€‚

```js
module.exports = {
  theme: {
    extend: {
      typography: () => ({
        DEFAULT: {
          css: {
            '--tw-prose-quote-borders': 'var(--tpm-primary)',
          },
        },
        invert: {
          css: {
            '--tw-prose-quote-borders': 'var(--tpm-primary-invert)',
          },
        },
      }),
    },
  },
  plugins: [require('@tailwindcss/typography')],
};
```

ç„¶åè¿˜éœ€è¦åœ¨`src\index.css`å¯¼å…¥ï¼š`@config "../tailwind.config.js";`ã€‚

### ã€å›°éš¾ã€‘ç¼–å†™ postcss æ’ä»¶ï¼šå¦‚ä½•åœ¨ marked + highlight.js ä¸­å®ç°åˆ‡æ¢ä»£ç å—é£æ ¼

å›é¡¾ä¸€ä¸‹æˆ‘ä¹‹å‰è®¾æƒ³çš„æ›´æ–°é¢œè‰²çš„æ–¹å¼ï¼š`const codeNodeComputedStyle = getComputedStyle(codeNode, null);`ï¼Œç„¶åå†™å…¥å¯¹åº”DOMå…ƒç´ çš„styleå±æ€§ã€‚ç°åœ¨æˆ‘å¸Œæœ›å®ç°åˆ‡æ¢ä»£ç å—é£æ ¼çš„èƒ½åŠ›ï¼Œå´æ‚²ç—›åœ°å‘ç°ä¹‹å‰è®¾æƒ³çš„åšæ³•ä¸å¯è¡Œã€‚åªè¦æˆ‘éœ€è¦åœ¨åˆ‡æ¢æ—¶å‘èµ·è¯·æ±‚ï¼Œé‚£`getComputedStyle`çš„å¯è¡Œçš„è°ƒç”¨æ—¶æœºå°±å–å†³äºç½‘ç»œè¯·æ±‚äº†ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬å°±æ— æ³•ç¡®å®šä¸€ä¸ªåˆç†çš„`setTimeout`çš„å»¶è¿Ÿç§’æ•°ã€‚è¯¦è§æˆ‘ä¹‹å‰è®°å½•çš„[åºŸæ¡ˆæ–‡æ¡£ï¼š`docs\æ ·å¼ç±»éœ€æ±‚\ã€åºŸæ¡ˆã€‘hljsThemeåºŸæ¡ˆè®°å½•.md`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/docs/%E6%A0%B7%E5%BC%8F%E7%B1%BB%E9%9C%80%E6%B1%82/%E3%80%90%E5%BA%9F%E6%A1%88%E3%80%91hljsTheme%E5%BA%9F%E6%A1%88%E8%AE%B0%E5%BD%95.md)ã€‚

åæ¥æˆ‘æƒ³åˆ°äº†ä¸€ç§ä¸é”™çš„åšæ³•ï¼šæŠŠ`highlight.js`æä¾›çš„æ‰€æœ‰CSSä»£ç éƒ½æ‹¿åˆ°ï¼Œå­˜åœ¨æŸä¸ªJSæ–‡ä»¶é‡Œï¼Œç„¶åç”¨`postcss`æ’ä»¶ä¿®æ”¹é€‰æ‹©å™¨ä¸ºæˆ‘ä»¬æ‰€æœŸæœ›çš„æ ·å­ï¼Œæœ€åæŠŠCSSä»£ç æ’å…¥åˆ°é¡µé¢ã€‚è¿™ä¸ªæ–¹æ¡ˆçš„å¥½å¤„æ˜¯ï¼Œåªè¦èƒ½çœ‹è§ç½‘é¡µï¼Œæ‰€æœ‰çš„CSSä»£ç å°±éƒ½åœ¨æœ¬åœ°ï¼Œåˆ‡æ¢æ—¶ä¸éœ€è¦å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚ä½†å…¶åå¤„æ˜¯ï¼Œä¸€ä¸ªç”¨æˆ·åå¥½çš„ä¸»é¢˜å¯èƒ½å°±é‚£å‡ ç§ï¼Œä½†æ‰€æœ‰ç”¨æˆ·éƒ½è¢«è¿«åœ¨çœ‹è§ç½‘é¡µå‰ç­‰å¾…å«æœ‰æ‰€æœ‰CSSä»£ç çš„JSä»£ç åŠ è½½å®Œæ¯•ã€‚æˆ‘çœ‹åˆ°`highlight.js`çš„CSSä»£ç ï¼ˆæˆ‘æŠŠå®ƒä»¬å­˜å‚¨åœ¨`src\common\hljsThemeCssText.js`ï¼‰å¤§æ¦‚æœ‰115kbï¼Œæ„Ÿè§‰æ²¡æœ‰éå¸¸ç³Ÿç³•ï¼Œå†³å®šå°±å…ˆè¿™æ ·åšã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å†™ä¸€ä¸ª[è„šæœ¬ï¼š`src\scripts\generate-new-hljs-theme-css.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/scripts/generate-new-hljs-theme-css.js)ç”Ÿæˆæ‰€æœ‰éœ€è¦çš„CSSä»£ç ã€‚

1. åŒæ ·ä½¿ç”¨äº†å¯¹é”®å€¼å¯¹æ’åºçš„æŠ€å·§ã€‚åœ¨`highlight.js`æ›´æ–°åï¼Œéœ€è¦å†æ¬¡è¿è¡Œè„šæœ¬æ—¶ï¼Œå¯ä»¥å‡å°‘ git diff ä¿¡æ¯ã€‚
2. æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªè„šæœ¬ç”¨åˆ°çš„ä¸€ä¸ªæˆ‘è‡ªå·±ç¼–å†™çš„postcssæ’ä»¶ã€‚è¿™ä¸ªæ’ä»¶éœ€è¦æŠŠï¼š

```css
.hljs {
  background: #e7e9db;
  color: #4f424c
}
```

æ”¹å†™ä¸ºï¼š

```css
.code-block-wrapper, .hljs {
  background: #e7e9db;
  color: #4f424c
}
```

ä½†å®æµ‹å‘ç°ï¼Œå¹¶éæ‰€æœ‰ä¸»é¢˜çš„CSSæ ¼å¼éƒ½è¿™ä¹ˆç®€å•ã€‚æ¯”å¦‚`node_modules\highlight.js\styles\nord.css`æ˜¯è¿™æ ·çš„ï¼š

```css
.hljs {
  background: #2E3440
}
.hljs,
.hljs-subst {
  color: #D8DEE9
}
```

ä½†ä¸ç¬¦åˆä¸Šè¿°ç®€å•æ ¼å¼çš„CSSä¸»é¢˜åªæœ‰2ä¸ªï¼Œå‡ºäºå¯¹å¿«é€Ÿå®ç°éœ€æ±‚çš„è€ƒè™‘ï¼Œæˆ‘å†³å®šåœ¨è¿è¡Œpostcssæ’ä»¶åï¼Œæ‰‹åŠ¨ä¿®æ”¹è¿™ä¸¤ä¸ªCSSä¸»é¢˜çš„ä»£ç ï¼Œè¯¦è§[`docs\æ ·å¼ç±»éœ€æ±‚\hljsTheme.md`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/docs/%E6%A0%B7%E5%BC%8F%E7%B1%BB%E9%9C%80%E6%B1%82/hljsTheme.md)ã€‚

postcssæ’ä»¶çš„è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š

```js
import postcss from 'postcss';

const result = await postcss([
  modifyHljsSelectorPlugin,
]).process(cssContent, { from: undefined });
```

è¿™ä¸ª`modifyHljsSelectorPlugin`æ˜¯ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„å‡½æ•°ï¼Œå¹¶ä¸”éœ€è¦è®¾ç½®`modifyHljsSelectorPlugin.postcss = true`ã€‚ä½†ä¸ºäº†ä¼˜é›…åœ°æ”¶é›†æˆ‘ä¿®æ”¹çš„é€‰æ‹©å™¨ï¼Œæˆ‘æŠŠå®ƒåŒ…äº†ä¸€å±‚ï¼Œå˜æˆäº†2é˜¶å‡½æ•°ï¼Œå¦‚ä¸‹ï¼ˆ[`src\scripts\modifyHljsSelectorPlugin.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/scripts/modifyHljsSelectorPlugin.js)ï¼‰ï¼š

```js
export default function getModifyHljsSelectorPlugin(onModify) {
  const modifyHljsSelectorPlugin = () => {
    // ...
  };
  modifyHljsSelectorPlugin.postcss = true;
  return modifyHljsSelectorPlugin;
}
```

æ’ä»¶çš„å®ç°ç»†èŠ‚å°±ä¸è¯´å•¦ï¼Œæ¯•ç«Ÿ~~è¿™æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆçš„æ ¸å¿ƒç«äº‰åŠ›~~ï¼Œæ¯”è¾ƒç®€å•ï¼Œç”¨DeepSeekç”Ÿæˆï¼ˆç›´æ¥ç”¨ç½‘é¡µç‰ˆç”Ÿæˆï¼Œä¼šä½¿ç”¨å·²ç»åºŸå¼ƒçš„è€å†™æ³•ï¼‰ï¼Œç„¶åæœç´¢å¼•æ“æœä¸‹æœ€æ–°ç”¨æ³•ï¼Œç…§ç€æ”¹å³å¯ã€‚

å’³å’³ï¼Œè¿˜æ˜¯ç®€å•è¯´è¯´ã€‚`Rule(rule)`æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡`rule.selector`æ‹¿åˆ°æ¯ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œç›´æ¥å¯¹å®ƒèµ‹å€¼å°±èƒ½ä¿®æ”¹é€‰æ‹©å™¨ã€‚æˆ‘ä»¬ç”¨`selectorParser`ï¼ˆ`import selectorParser from 'postcss-selector-parser'`ï¼‰æ‹¿åˆ°é€‰æ‹©å™¨çš„ä¸€äº›å±æ€§ï¼Œç­›é€‰å‡ºåªæœ‰`.hljs`çš„ã€‚ç„¶åç”¨postcsséå†ä»£ç å—çš„æ¯ä¸€æ¡å£°æ˜ï¼š

```js
let hasBackground = false, hasColor = false;
rule.walkDecls(decl => {
  if (decl.prop === 'background' || decl.prop === 'background-color') hasBackground = true;
  if (decl.prop === 'color') hasColor = true;
});
if (!hasBackground || !hasColor) return;
```

å°±å®Œæˆäº†æ•´ä¸ªåˆ¤å®šå·¥ä½œã€‚

å¦å¤–ï¼Œæˆ‘è°ƒè¯•æ—¶å‘ç°ä¸»é¢˜`pojoaque.css`å’Œ`brown-paper.css`æ˜¯æœ‰èƒŒæ™¯å›¾ç‰‡çš„ï¼Œæˆ‘ä»¬æŠŠä»£ç å¤åˆ¶åˆ°JSæ–‡ä»¶åï¼Œå®ƒä»¬çš„èƒŒæ™¯URLçš„å†™æ³•å°±éœ€è¦æ”¹ã€‚æœ€å®¹æ˜“æƒ³åˆ°çš„åŠæ³•å°±æ˜¯å¼•å…¥ä¸€ä¸ªå ä½ç¬¦ï¼Œåœ¨æ°å½“æ—¶æœºæ›´æ–°ã€‚æ¯”å¦‚`pojoaque.css`ï¼š

```css
.code-block-wrapper, .hljs {
  color: #dccf8f;
  background: url(__VITE_BASE_PATH__/pojoaque.jpg) repeat scroll left top #181914
}
```

æˆ‘é€‰æ‹©çš„æ›´æ–°æ—¶æœºæ˜¯åˆ›å»ºstyleæ ‡ç­¾æ’å…¥é¡µé¢æ—¶ï¼š

```js
// src\hooks\useHljsTheme.js
function getThemeCssContent(actualHljsTheme) {
  const cssContent = hljsThemeCssText[actualHljsTheme] || '';
  const basePath = getWebsiteBasePath().slice(0, -1);
  return cssContent.replaceAll('__VITE_BASE_PATH__', basePath);
}

// call
styleEl.textContent = getThemeCssContent(actualHljsTheme);
```

æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠç”Ÿæˆçš„CSSä»£ç æ’å…¥åˆ°é¡µé¢ï¼š

```jsx
// src\component\layout\SettingsDialog.jsx
const { hljsTheme, setHljsTheme } = useSettingsStore();
<div className={widthClassName}>
  <TpmCombobox
    value={hljsTheme}
    setValue={setHljsTheme}
    options={hljsThemeOptions}
  />
</div>
```

ç„¶åæˆ‘ä»¬ç›´æ¥åœ¨æ‰€æœ‰é¡µé¢éƒ½å¼•å…¥ä¸€ä¸ªå‰¯ä½œç”¨ï¼š

```js
// src\component\layout\Layout.jsx
export default function Layout({ children }) {
  useHljsTheme();
  // ...
}
```

ä¸ºä¼˜é›…èµ·è§ï¼Œæˆ‘ä»¬ä¸å¦¨å°è£…ä¸€ä¸ªè‡ªå®šä¹‰hookï¼ˆ`src\hooks\useHljsTheme.js`ï¼‰ï¼Œè¿™ä¸ªhookåšçš„äº‹å¾ˆç®€å•ï¼šè¯»å–`const { hljsTheme } = useSettingsStore()`å¹¶æ’å…¥ä¸€ä¸ªstyleæ ‡ç­¾ã€‚

## ç”¨æ’å€¼ç®—æ³•ç¡®å®šç½‘ç«™çš„é…è‰²

ä½œä¸ºä¸€åå‰ç«¯å·¥ç¨‹å¸ˆï¼Œæ²¡æœ‰è®¾è®¡åŸºç¡€ï¼Œç¡®å®šç½‘ç«™çš„é…è‰²è¿™ä»¶äº‹è¿˜æ˜¯æœ‰ç‚¹ä¼¤è„‘ç­‹ã€‚

- å¦‚æœé¡¹ç›®ç”¨åˆ°`antd`ï¼Œé‚£ä¹ˆä¸å¤ªéœ€è¦æ€è€ƒè¿™ä¸ªé—®é¢˜ï¼Œé€‰èƒŒæ™¯è‰²å’Œå­—ä½“å°±OKã€‚
- å¦‚æœé¡¹ç›®ç”¨åˆ°`shadcn-ui`ï¼Œé‚£ä¹ˆå¯ä»¥å» https://tweakcn.com/ æ‰¾ç°æˆçš„ä¸»é¢˜ã€‚

æˆ‘çš„é¡¹ç›®æ²¡æœ‰ç”¨ä»¥ä¸Šç»„ä»¶åº“ï¼Œä½†æˆ‘ä»¬å·²ç»è¿›å…¥LLMæ—¶ä»£ï¼Œä¸å¦¨å€ŸåŠ©LLMç¡®å®šåˆå§‹çš„ç½‘ç«™æ ·å¼é£æ ¼ã€‚æˆ‘ç›®å‰é‡‡ç”¨çš„æ€è·¯æ˜¯ï¼šå…ˆè®©DeepSeekç”Ÿæˆä¸€ä¸ªç½‘ç«™ï¼Œçœ‹ç€æ ·å¼OKï¼Œå°±ç”¨å®ƒçš„é…è‰²å’Œå­—ä½“äº†ã€‚ä¹‹åå†ç”¨**æ’å€¼ç®—æ³•**ç¡®å®šä¸€äº›é…è‰²çš„ç»†èŠ‚ã€‚

DeepSeekç»™æˆ‘ç”Ÿæˆäº†ä¸€ä¸ªå¤©è“è‰²ï¼ˆ`b = RGB(178, 222, 236)`ï¼‰èƒŒæ™¯çš„HTMLï¼Œæˆ‘çš„ç›®æ ‡æ˜¯ç¡®å®šå¯¼èˆªæ ç­‰éƒ¨åˆ†çš„é…è‰²ã€‚LLMç”Ÿæˆçš„é…è‰²ä¸€èˆ¬éƒ½æ˜¯å¤§æ¸å˜ï¼Œæˆ‘åªè¦ç¡®å®šæ¸å˜çš„ä¸¤ç«¯å³å¯ã€‚æˆ‘åœ¨DeepSeekçš„è¾“å‡ºä¸­æ‰¾åˆ°äº†ä¸€ç§æ›´é²œè‰³çš„å¤©è“è‰²`#4cc9f0`ï¼Œè¿™ä¸ªå°±ä½œä¸ºèµ·ç‚¹ï¼Œç„¶åç”¨ä¸‹é¢è¿™æ®µä»£ç åœ¨ä¸¤è€…ä¹‹é—´å–ç‚¹ä½œä¸ºç»ˆç‚¹å³å¯ï¼š

```js
function getGradientColor(color1, color2, percent) {
  // HEXè½¬RGBå‡½æ•°
  const hexToRgb = hex =>
    hex.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i, (_, r, g, b) => '#' + r + r + g + g + b + b)
      .substring(1).match(/.{2}/g)
      .map(x => parseInt(x, 16));

  // RGBè½¬HEXå‡½æ•°
  const rgbToHex = (r, g, b) =>
    '#' + [r, g, b].map(x => x.toString(16).padStart(2, '0')).join('');

  const [r1, g1, b1] = hexToRgb(color1);
  const [r2, g2, b2] = hexToRgb(color2);
  const ratio = percent / 100;

  const r = Math.round(r1 + (r2 - r1) * ratio);
  const g = Math.round(g1 + (g2 - g1) * ratio);
  const b = Math.round(b1 + (b2 - b1) * ratio);

  return rgbToHex(r, g, b);
}

// ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–50%ä½ç½®çš„é¢œè‰²ï¼‰
const midColor = getGradientColor('#4CA1A3', '#82CDE6', 50);
console.log(midColor); // è¾“å‡º #67b7c5
```

è¿™æ®µä»£ç ä¹Ÿä¸éœ€è¦è‡ªå·±å†™ï¼Œåªéœ€è¦é—®DeepSeekè¦ï¼šâ€œå¤§ä½¬ï¼Œå¦‚ä½•è·å¾—CSSçº¿æ€§æ¸å˜çš„ä¸¤ä¸ªé¢œè‰²ä¹‹é—´çš„æŸä¸ªé¢œè‰²å€¼ï¼Ÿä»¥background: linear-gradient(135deg, #4CA1A3 0%, #82CDE6 100%);ä¸ºä¾‹ã€‚â€

## å­—ä½“é€‰æ‹©

æ•ˆæœï¼š

![3-å­—ä½“å±•ç¤º.png](./README_assets/3-å­—ä½“å±•ç¤º.png)

æˆ‘é€‰æ‹©åœ¨bodyæ ‡ç­¾è®¾ç½®é»˜è®¤å­—ä½“ä¸ºâ€œç«™é…·å¿«ä¹ä½“â€ï¼Œæ ‡é¢˜æ ‡ç­¾h1åˆ°h6æˆ‘åˆ™é€‰æ‹©äº†â€œè†å—æ³¢æ³¢é»‘â€ï¼ˆæ¥æºéƒ½æ˜¯ï¼š https://zhuanlan.zhihu.com/p/690446851/ ï¼‰ã€‚æˆ‘è§‰å¾—è¿™ä¸¤ä¸ªå­—ä½“çš„é¢œå€¼éƒ½ä¸é”™ï¼Œä½†è†å—æ³¢æ³¢é»‘é»˜è®¤å°±æ˜¯åŠ ç²—çš„ï¼Œå†è®¾ç½®åŠ ç²—å°±ä¼šå¤ªæ‹¥æŒ¤äº†ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰æŠŠå®ƒè®¾ä¸ºé»˜è®¤å­—ä½“ï¼Œè€Œæ˜¯ä»…ç”¨åœ¨æ ‡é¢˜ã€‚

`public\chinese-fonts.css`ï¼š

```css
/* æ¥æºï¼š https://zhuanlan.zhihu.com/p/690446851/ */

@font-face {
  font-family: 'Jing Nan Bo Bo Hei';
  font-display: swap;
  src: url(jing-nan-bo-bo-hei-bold.ttf);
}

@font-face {
  font-family: 'Zhan Ku Kuai Le Ti';
  font-display: swap;
  src: url(zhan-ku-kuai-le-ti.ttf);
}
```

`index.html`ï¼š

```html
<link
  href="/chinese-fonts.css"
  rel="stylesheet"
>
```

ä½¿ç”¨ï¼š

```scss
body {
  font-family: 'Zhan Ku Kuai Le Ti', 'Fredoka One', sans-serif;
}

.teachingPlanH1,
.teachingPlanH2,
.teachingPlanH3,
.teachingPlanH4,
.teachingPlanH5,
.teachingPlanH6 {
  font-family: 'Jing Nan Bo Bo Hei', 'Fredoka One', cursive;
  font-weight: bold;
  color: var(--text-dark);
}
```

## ã€å›°éš¾ã€‘ç±»ä¼¼äºç»„ä»¶åº“æ–‡æ¡£å±•ç¤ºéƒ¨åˆ†æºç çš„éœ€æ±‚ï¼šåœ¨è¯¾ä»¶ä¸­å±•ç¤ºGeoGebraçš„`appletOnLoad`çš„ä»£ç 

æˆ‘çš„æ‰€æœ‰è¯¾ä»¶çš„`appletOnLoad`æ–¹æ³•éƒ½æ˜¯å†™åœ¨é…ç½®æ–‡ä»¶é‡Œçš„ï¼Œå› æ­¤æˆ‘æœ€å¼€å§‹é‡‡ç”¨äº†éå¸¸ç®€å•ç²—æš´çš„å®ç°ï¼ˆ`src\component\teachingPlan\StandardPage.jsx`ï¼‰ï¼š

```jsx
function Inner({ config }) {
  // ...
  const appletOnLoadCodeBlockList = useMemo(() => {
    return config.geogebraSection.geogebraList.map((geogebra) => {
      const appletOnLoadSrcCode = geogebra.config.appletOnLoad.toString();
      const appletOnLoadFormattedCode = js_beautify(appletOnLoadSrcCode, JS_BEAUTIFY_OPTIONS);
      const res = `
\`\`\`js
${appletOnLoadFormattedCode}
\`\`\`
`;
      return res;
    });
  }, [config]);
  // ...
}
```

è¿™ä¸ªå®ç°çš„é—®é¢˜æ˜¯ï¼Œå¼€å‘é˜¶æ®µèƒ½æ‹¿åˆ°æºç ï¼Œä½†æ„å»ºé˜¶æ®µæºç è¢«å‹ç¼©äº†ï¼Œä¿¡æ¯ä¸¢å¤±äº†ã€‚å› æ­¤æˆ‘æ‰“ç®—å†™ä¸€ä¸ªnodejsè„šæœ¬ï¼ˆä¼ é€é—¨ï¼š[`src\scripts\geogebra-src-code-collect.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/scripts/geogebra-src-code-collect.js)ï¼‰ï¼Œç”¨Babelè¯»å–è¿™äº›é…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°è¿™äº›ä»£ç åæŠŠå®ƒä»¬æ”¶é›†èµ·æ¥ï¼Œæ”¾åˆ°ä¸€ä¸ªå«`src\appletOnLoadCollection.js`çš„æ–°æ–‡ä»¶é‡Œã€‚ç®€å•æ€»ç»“ä¸€ä¸‹æƒ³è¾¾åˆ°çš„æ•ˆæœï¼š

1. æ”¶é›†æ‰€æœ‰`appletOnLoad`å‡½æ•°ï¼Œç”Ÿæˆ`src\appletOnLoadCollection.js`ã€‚å®ƒæ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨ã€‚
2. ä¸ºäº†è®©`StandardPage.jsx`æ–¹ä¾¿æ‹¿åˆ°ä»£ç ï¼Œè„šæœ¬éœ€è¦è‡ªåŠ¨ä¿®æ”¹è¯¾ä»¶é…ç½®æ–‡ä»¶ï¼ŒåŠ ä¸Šè®¿é—®keyï¼ˆæˆ‘å‘½åä¸º`appletOnLoadId`ï¼‰ã€‚å¹¶ä¸”æˆ‘ä»¬å¸Œæœ›ä¿®æ”¹å¾—å°½é‡å°‘ï¼Œè®©git diffæ›´å¥½çœ‹ã€‚
3. ç›‘å¬è¯¾ä»¶é…ç½®æ–‡ä»¶çš„æ›´æ”¹ï¼Œè‡ªåŠ¨æ‰§è¡Œä»¥ä¸Šæµç¨‹ã€‚

è¿™ä¸ªè‡ªç„¶ä¸å¯èƒ½å¤æ³•æ‰‹ä½œï¼Œå½“ç„¶æ˜¯è®©DeepSeekç”Ÿæˆã€‚æˆ‘ä»¬æœ€ç»ˆç¡®å®šçš„æŠ€æœ¯æ ˆå¦‚ä¸‹ï¼š

1. ç”¨Babelæå–ä¿¡æ¯ï¼Œä½†ä¸èƒ½ç›´æ¥ä½¿ç”¨`@babel/generator`é‡æ–°ç”Ÿæˆä»£ç ï¼Œå› ä¸ºä¼šæœ‰å¤§é‡git diffã€‚æˆ‘ä»¬éœ€è¦ä»¥è¡Œæˆ–å­—ç¬¦ä¸ºå•ä½ï¼Œç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ä¾èµ–**æ–‡ä»¶çš„ç‰¹å®šæ ¼å¼**ï¼Œæ¯”å¦‚ï¼šæ¯ä¸ªé”®å€¼å¯¹éƒ½å•ç‹¬å ä¸€è¡Œï¼Œä¸”æ¯ä¸ªå±æ€§åéƒ½æœ‰é€—å·ã€‚å¹¸å¥½æˆ‘ä»¬å·²ç»é…ç½®äº†eslintã€‚
2. ç”Ÿæˆ`src\appletOnLoadCollection.js`æ—¶ï¼Œæˆ‘ä»¬ä¸å¦¨å¯¹é”®æ’åºï¼Œä»¥å‡å°‘git diffã€‚
3. ç”¨`glob`å®šä½æ‰€æœ‰çš„è¯¾ä»¶é…ç½®æ–‡ä»¶ï¼Œç”¨`chokidar`ç›‘å¬æ–‡ä»¶ä¿®æ”¹ã€‚

ä»£ç æ€»å…±æœ‰300å¤šè¡Œï¼Œå°±ä¸å®Œæ•´è´´å‡ºæ¥äº†ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯æŸ¥çœ‹ï¼š[`src\scripts\geogebra-src-code-collect.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/scripts/geogebra-src-code-collect.js)ã€‚

æœ€åè¿˜éœ€è¦é…ä¸ªå‘½ä»¤ï¼š

```json
"dev": "concurrently -n 'geog,vite' 'bun watch:geogebra' 'bunx --bun vite'",
"watch:geogebra": "bun src/scripts/geogebra-src-code-collect.js",
```

æˆ‘ä»¬å¸Œæœ›åŒæ—¶æ‰§è¡Œviteå‘½ä»¤å’Œ`watch:geogebra`å‘½ä»¤ï¼Œæ‰€ä»¥éœ€è¦ä¸‹ä¸€ä¸ªå«`concurrently`çš„åŒ…ï¼š`bun add -D concurrently`ã€‚

### vitestå•æµ‹

ç»™DeepSeekçš„æç¤ºè¯ï¼š

```markdown
å¤§ä½¬ï¼Œä½ æ˜¯ä¸€åä¸“å®¶å‰ç«¯å·¥ç¨‹å¸ˆï¼Œç²¾é€šå‰ç«¯å·¥ç¨‹åŒ–ã€‚è¯·å«æˆ‘hans7ã€‚æˆ‘æœ‰ä¸€ä¸ªreact + viteé¡¹ç›®ï¼Œæœ‰src\scripts\geogebra-src-code-collect.jsä»£ç å¦‚ä¸‹ï¼š

è¯·ç¼–å†™é‡Œé¢é™¤mainå‡½æ•°ä»¥å¤–çš„æ‰€æœ‰å‡½æ•°çš„å•å…ƒæµ‹è¯•ã€‚æ³¨æ„ï¼šæ¡†æ¶ä¸ºvitestã€‚
```

å®ƒç”Ÿæˆçš„ä»£ç æŒºæ•·è¡çš„ï¼Œä½†ä¿®æ”¹ä¸€ä¸‹å‹‰å¼ºèƒ½ç”¨ã€‚ä¼ é€é—¨ï¼š[`tests\geogebra-src-code-collect.test.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/tests/geogebra-src-code-collect.test.js)ã€‚

å¦‚ä½•mockæ¨¡å—ï¼š

```js
vi.mock('fs');
vi.mock('path');
vi.mock('glob');
vi.mock('chokidar', () => ({
  default: {
    watch: vi.fn().mockImplementation(() => {
      const ret = {};
      ret.on = vi.fn().mockImplementation(() => {
        return ret;
      });
      return ret;
    }),
  },
}));
vi.mock('js-beautify', () => ({
  js_beautify: vi.fn().mockImplementation(code => `beautified(${code})`),
}));

  // describe ä¸­ï¼š
  beforeEach(() => {
    vi.clearAllMocks();
  });
```

å¦‚ä½•åœ¨VSCodeä¸­è°ƒè¯•vitestï¼š[å‚è€ƒé“¾æ¥2](https://cn.vitest.dev/guide/debugging)ã€‚æ‰“å¼€ä¸€ä¸ªæ–°çš„`JavaScript Debug Terminal`ï¼Œç„¶åæ­£å¸¸æ‰§è¡Œ`bun run test`å³å¯ã€‚

### 250729ï¼šå¦‚ä½•è§£å†³é…ç½®`VITE_DEPLOY_TARGET`ç¯å¢ƒå˜é‡åï¼Œvitestå•æµ‹è¿è¡Œå¤±è´¥çš„é—®é¢˜

æˆ‘é—®DeepSeekçš„Promptï¼š

```markdown
å¤§ä½¬ï¼Œæˆ‘æ‰§è¡Œ`bun run test`æ—¶å‘ç°ï¼Œæµ‹è¯•ç”¨ä¾‹è¿è¡Œä¹‹å‰ä¼šè¿è¡Œvite.config.jsï¼Œè€Œå®ƒå¼•ç”¨äº†`import.meta.env.VITE_DEPLOY_TARGET`ç¯å¢ƒå˜é‡ï¼Œå¯¼è‡´æŠ¥é”™ï¼š

failed to load config from teaching-plan-analytic-geometry\vite.config.js

TypeError: Cannot read properties of undefined (reading 'VITE_DEPLOY_TARGET')

è¯·é—®å¦‚ä½•è§£å†³ï¼Ÿ
```

å®ƒç»™çš„è§£å†³æ–¹æ¡ˆå¤§éƒ½ä¸é è°±ï¼Œä½†æˆ‘é€‰æ‹©äº†å…¶ä¸­ä¸€ä¸ªï¼šæ–°å»ºä¸€ä¸ªç©ºçš„`vitest.config.js`ï¼Œäº²æµ‹OKã€‚

```js
import { defineConfig } from 'vitest/config';
import path from 'path';

export default defineConfig({
  test: {
    // ... Specify options here.
  },
  // åº”å’Œ vite.config.js é…çš„ä¸€æ ·
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
});
```

### åœ¨vitestä¸­å¦‚ä½•æµ‹è¯•ç»„ä»¶

å®‰è£…ç›¸å…³çš„åŒ…ï¼š

```bash
bun add -D @testing-library/react @vitejs/plugin-react jsdom @testing-library/user-event
```

ä¿®æ”¹`vitest.config.js`é…ç½®ï¼š

```js
import { defineConfig } from 'vitest/config';
import react from '@vitejs/plugin-react';
// ...

export default defineConfig({
  plugins: [
    react(),
  ],
  test: {
    environment: 'jsdom',
    setupFiles: 'tests/rtlInVitest.setup.js',
  },
  // ...
});
```

è¿™ä¸ª setup æ–‡ä»¶ä¸èƒ½çœï¼Œå¦åˆ™è¿è¡Œä¼šè¯´ä¸å­˜åœ¨`Chai`ï¼ˆå¦ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼‰å±æ€§ä¹‹ç±»çš„ã€‚`tests\rtlInVitest.setup.js`ï¼š

```js
import { afterEach } from 'vitest';
import { cleanup } from '@testing-library/react';
import '@testing-library/jest-dom/vitest';

// å…¨å±€è®¾ç½®æ¸…ç†å‡½æ•°ï¼Œé¿å…æ¯ä¸ªæµ‹è¯•æ–‡ä»¶æ‰‹åŠ¨æ¸…ç†
afterEach(() => {
  cleanup();
});
```

### è¸©å‘ï¼šä¸å»ºè®®ä½¿ç”¨`fireEvent`ï¼Œå»ºè®®ä½¿ç”¨`userEvent`

æˆ‘åœ¨å†™`pagination-with-toolbar`è¿™ä¸ªç»„ä»¶çš„å•æµ‹ç”¨ä¾‹æ—¶ï¼Œæœ‰å¦‚ä¸‹ä»£ç ï¼ˆ`tests\pagination-with-toolbar.test.jsx`ï¼‰ï¼š

```jsx
vi.mock('@/component/ui/select', () => ({
  Select: vi.fn(({ children, defaultValue, onValueChange }) => (
    <select data-testid="select" defaultValue={defaultValue} onChange={(e) => {
      onValueChange(e.target.value);
    }}>
      {children}
    </select>
  )),
  SelectContent: vi.fn(({ children }) => children),
  SelectItem: vi.fn(({ value, children }) => <option value={value}>{children}</option>),
  SelectTrigger: vi.fn(({ children }) => children),
  SelectValue: vi.fn(() => 'Select Value Placeholder'),
}));
```

ç„¶åç”¨å¦‚ä¸‹ä»£ç è§¦å‘é€‰ä¸­äº‹ä»¶ï¼ŒæœŸæœ›æ‰§è¡Œä¸Šé¢çš„`onValueChange`æ–¹æ³•ï¼š

```js
import { fireEvent } from '@testing-library/react';

const select = screen.getByTestId('select');
fireEvent.change(select, { target: { value: '25' } });
```

å´å‘ç°ï¼Œ`e.target.value`å§‹ç»ˆéƒ½åªèƒ½æ‹¿åˆ°ç©ºå­—ç¬¦ä¸²ã€‚æˆ‘é—®äº†DeepSeekä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡å®ƒå»ºè®®æˆ‘æ‰‹åŠ¨æ”¹`select.value = '20'`ã€‚ä½†æˆ‘å‘ç°`select`æ˜¯ä¸€ä¸ªProxyï¼Œæ”¹ä¸äº†ã€‚æˆ‘å°±é—®å®ƒç¬¬äºŒæ¬¡ï¼Œå®ƒè¿™æ¬¡å‘Šè¯‰æˆ‘å¯ä»¥æ”¹ç”¨`@testing-library/user-event`åŒ…ã€‚æˆ‘è¯•äº†è¯•ï¼Œæœç„¶OKäº†ã€‚ç›¸å…³ä»£ç ï¼š

```js
import userEvent from '@testing-library/user-event';

it('changes items per page and resets to page 1', async () => {
  const setItemsPerPage = vi.fn();
  const onPageChange = vi.fn();

  render(
    <PaginationWithToolbar
      {...defaultProps}
      setItemsPerPage={setItemsPerPage}
      onPageChange={onPageChange}
    />
  );

  const select = screen.getByTestId('select');

  await userEvent.selectOptions(select, '20');

  expect(setItemsPerPage).toHaveBeenCalledWith('20');
  expect(onPageChange).toHaveBeenCalledWith(1);

  await userEvent.selectOptions(select, '50');

  expect(setItemsPerPage).toHaveBeenCalledWith('50');
  expect(onPageChange).toHaveBeenCalledWith(1);
});
```

## ã€å¸¸è§„ã€‘å®ç°åšå®¢åˆ—è¡¨å’Œåšå®¢è¯¦æƒ…é¡µ

æˆ‘æœ€è¿‘åˆ·åˆ°ä¸€äº›è®²æ•°å­¦é¢˜çš„Bç«™è§†é¢‘ï¼Œåˆæƒ³èµ·äº†è‡ªå·±é«˜ä¸­å½“åšé¢˜å®¶çš„å³¥åµ˜å²æœˆï¼Œäºæ˜¯æŠ½ç©ºé—²æ—¶é—´åœ¨obsidianå†™äº†äº›ç¬”è®°ã€‚æ‰€ä»¥æˆ‘å¸Œæœ›åœ¨è¿™ä¸ªé¡¹ç›®å®ç°ä¸€äº›é¡µé¢ï¼ŒæŠŠè¿™äº›æ•°å­¦åšå®¢å±•ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”å’Œè¯¾ä»¶ï¼Œä»¥åŠGeoGebraçº¯äº«ç­‰æ¨¡å—å…³è”èµ·æ¥ã€‚æˆ‘è¿™äº›æ•°å­¦åšå®¢ä¼šå……åˆ†ä½¿ç”¨LLMã€GeoGebraç­‰å·¥å…·ï¼Œå®ç°å¿«é€Ÿç¼–å†™å’Œè¶³å¤Ÿç¡¬æ ¸çš„å¹³è¡¡ã€‚

### è™šæ‹Ÿæ¨¡å—ï¼š`virtual:blog-data`

æŒ‰å¸¸è§„çš„å‰åç«¯é¡¹ç›®ï¼Œå±•ç¤ºåšå®¢æ˜¯éœ€è¦ä¸€ä¸ªåç«¯çš„ã€‚ä½†è¿™ä¸ªé¡¹ç›®æ˜¯çº¯å‰ç«¯é¡¹ç›®ï¼Œå› æ­¤æˆ‘æ‰“ç®—å†™ä¸€ä¸ªè™šæ‹Ÿæ¨¡å—æ¥CRUDåšå®¢çš„ä¸€äº›å±æ€§ã€‚åœ¨å¤æ³•æ‰‹ä½œç¼–ç¨‹çš„æ—¶ä»£ï¼Œæˆ‘ä¼šç›´æ¥æŠ•é™ï¼Œå¯åŠ¨åç«¯é¡¹ç›®ã€‚ä½†ç°åœ¨æœ‰LLMçš„åŠ æŒï¼Œæˆ‘è®¤ä¸ºè¿™ä¸ªå·¥ä½œé‡æ˜¯å¯ä»¥æ¥å—çš„ã€‚æˆ‘æ‰“ç®—åœ¨å‰ç«¯å±•ç¤ºåšå®¢çš„åˆ›å»ºæ—¶é—´ã€æœ€è¿‘ä¿®æ”¹æ—¶é—´ã€æ ‡ç­¾ï¼Œç›¸å…³çš„`front-matter`ç¤ºä¾‹å¦‚ä¸‹ï¼š

```yaml
tags:
  - æ­£ç”¨éŸ¦è¾¾å®šç†
  - åˆ†ç±»è®¨è®º
  - åœ†é”¥æ›²çº¿ç¡¬è§£å®šç†
  - å¾…å®šç³»æ•°æ³•
title: å­˜åœ¨è¿‡æ¤­åœ†å³ç„¦ç‚¹çš„ç›´çº¿ï¼Œä½¿å¾—OAâŠ¥OBï¼Œæ±‚ç¦»å¿ƒç‡èŒƒå›´
ctime: '1754292981127'
ctime_f: '2025-08-04 15:36:21'
mtime: '1754587593215'
mtime_f: '2025-08-08 01:26:33'
```

[å®Œæ•´ä»£ç ä¼ é€é—¨ï¼š`src\plugins\vite-plugin-blog-data.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/plugins/vite-plugin-blog-data.js)

æˆ‘æ˜¯ç”¨DeepSeekç”Ÿæˆçš„ä¸»ä½“ä»£ç ï¼Œä½†å®ƒæ²¡æœ‰æˆ‘é¡¹ç›®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç”Ÿæˆä»£ç çš„å¾ˆå¤šç»†èŠ‚ä¸æ˜¯å¾ˆå¥½ï¼Œæˆ‘è¿˜æ˜¯æ‰‹åŠ¨æ”¹äº†ä¸å°‘ã€‚å’Œå‰é¢æåˆ°çš„ä¸¤ä¸ªè™šæ‹Ÿæ¨¡å—ä¸ä¸€æ ·çš„æ˜¯ï¼Œæˆ‘ä»¬è¿™æ¬¡é‡‡ç”¨äº†ä¹‹å‰ç”¨è¿‡çš„`chokidar`æ¥ç›‘å¬åšå®¢æ–‡ä»¶å˜åŒ–ï¼š

```js
const blogsDir = path.resolve(process.cwd(), 'docs', 'blogs');
      
const watcher = chokidar.watch(blogsDir, {
  ignored: (path, stats) => {
    return stats?.isFile() && !path.endsWith('.md');
  },
  ignoreInitial: true,
  persistent: true,
});

// æ–‡ä»¶å˜åŒ–æ—¶è§¦å‘ HMR
watcher
  .on('add', (filePath) => {
    console.log(`[${virtualModuleId}] File added: ${filePath}`);
    serverNotifyReload(server, resolvedVirtualModuleId);
  })
  .on('change', (filePath) => {
    console.log(`[${virtualModuleId}] File changed: ${filePath}`);
    serverNotifyReload(server, resolvedVirtualModuleId);
  })
  .on('unlink', (filePath) => {
    console.log(`[${virtualModuleId}] File removed: ${filePath}`);
    serverNotifyReload(server, resolvedVirtualModuleId);
  });
```

å¦å¤–ï¼Œä¸ºäº†è¯»å–åšå®¢çš„`front-matter`ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå«`gray-matter`çš„åŒ…ã€‚ç”¨å®ƒè¯»å†™`front-matter`ä¿¡æ¯éƒ½å¾ˆæ–¹ä¾¿ã€‚è¯»ä¿¡æ¯ï¼š

```js
import matter from 'gray-matter';
const { data, content } = matter(rawContent);
const title = data.title || path.basename(mdFile, '.md');
```

å†™ä¿¡æ¯ï¼š

```js
const newContent = matter.stringify(content, newFrontmatter, {
  language: 'yaml',
  delimiters: '---',
});
```

è¿™ä¸ªstringifyæ–¹æ³•æœ‰æ—¶å€™ä¼šå¯¼è‡´æˆ‘çš„æ—¥æœŸå˜ä¸ºDateå¯¹è±¡ç›´æ¥toStringçš„æ ¼å¼ï¼Œè¿™ä¸ªå°bugæˆ‘æš‚æ—¶æ‡’å¾—å¤„ç†ã€‚

### è‡ªåŠ¨ä¸ºåšå®¢æ·»åŠ Markdownæ ¼å¼çš„æ ‡é¢˜ï¼Œä»¥åŠ`ctime, mtime`

[å®Œæ•´ä»£ç ï¼š`src\scripts\blog-metadata-processor.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/scripts/blog-metadata-processor.js)

è¿™ä¸ªè„šæœ¬æˆ‘æ˜¯åœ¨Claude Code Cliè®©Kimi K2ç”Ÿæˆçš„ï¼ˆæç¤ºè¯ï¼š`docs\blogåŠŸèƒ½å¼€å‘\è‡ªåŠ¨æ·»åŠ titleã€ctimeç­‰å±æ€§.md`ï¼‰ï¼Œä½†å®ƒç”Ÿæˆçš„ä»£ç è´¨é‡ç¡®å®ä¸å¾—è¡Œï¼Œè¿ç”¨`gray-matter`è¯»å†™`front-matter`ä¿¡æ¯éƒ½ä¸çŸ¥é“ï¼Œç›¸æ¯”ä¹‹ä¸‹DeepSeekçš„è¡¨ç°å°±å¥½å¾—å¤šã€‚

ä¸ºäº†è§£å†³é€’å½’æ›´æ–°çš„é—®é¢˜ï¼Œæˆ‘åˆä¿®æ”¹è„šæœ¬ï¼Œè®©å®ƒç”Ÿæˆäº†ä¸ªcacheæ–‡ä»¶ï¼Œä¿å­˜æ¯ä¸ªæ–‡ä»¶çš„æ–‡æœ¬ï¼Œä»…åœ¨ä¸åŒ…æ‹¬`front-matter`ä¿¡æ¯çš„æ–‡ä»¶å†…å®¹å˜åŒ–æ—¶æ›´æ–°ä¿®æ”¹æ—¶é—´ã€‚è¿™ä¸ªcacheæ–‡ä»¶ä¸ä¼šè¢«æ‰“åŒ…è¿›äº§ç‰©ï¼Œå°±æ— ä¼¤å¤§é›…ã€‚è¿™ä¸ªcacheæ–‡ä»¶ä¸€æ ·è¦å…ˆå¯¹é”®å€¼å¯¹æ’åºå†å†™å…¥ï¼Œè¿™æ ·å¯ä»¥è®© git diff æ›´å°‘ã€‚

### åˆ—è¡¨é¡µå¸¸è§çš„ç­›é€‰èƒ½åŠ›

æ—¢ç„¶æœ‰åšå®¢åˆ—è¡¨é¡µï¼Œé‚£å°±å¿…é¡»æœ‰ç­›é€‰èƒ½åŠ›ï¼Œè¿™äº‹åšBç«¯çš„åŒå­¦éƒ½å¾ˆç†Ÿæ‚‰äº†ã€‚å’Œæ™®é€šçš„å‰åç«¯é¡¹ç›®ï¼ˆå‰ç«¯ç»™åç«¯å‘é€æ¥å£ï¼Œå¸¦`pageno`å’Œ`count`å‚æ•°ï¼‰ä¸åŒï¼Œè¿™æ˜¯ä¸ªçº¯å‰ç«¯é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘æ˜¯é€šè¿‡æˆªå–ä¸€ä¸ªå®Œæ•´æ•°ç»„çš„æ–¹å¼æ¥å®ç°åˆ†é¡µçš„ã€‚æˆ‘çœ‹shadcnå¹¶æ²¡æœ‰æä¾›antdé£æ ¼çš„åˆ†é¡µç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªã€‚ç›¸å…³ä»£ç ï¼š

- [`src\component\ui\numbered-pagination.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/ui/numbered-pagination.jsx) ï¼šç»“åˆ https://21st.dev/originui/numbered-pagination/default å’Œ https://21st.dev/originui/joined-pagination/default é­”æ”¹çš„
- [`src\component\ui\pagination-with-toolbar.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/ui/pagination-with-toolbar.jsx) ï¼šantd é£æ ¼çš„ Pagination ç»„ä»¶ã€‚å¯ä»¥è‡ªå®šä¹‰æ¯é¡µæ˜¾ç¤ºæ¡æ•°
- [ç›¸å…³å•æµ‹ï¼š`tests\pagination-with-toolbar.test.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/tests/pagination-with-toolbar.test.jsx)

å› ä¸ºè¿™æ˜¯ä¸ªå—æ§ç»„ä»¶ï¼ˆæˆ‘ç¡®å®æ„Ÿè§‰è®©å®ƒæ”¯æŒéå—æ§æ¨¡å¼æ¯”è¾ƒéº»çƒ¦ï¼‰ï¼Œå³`setCurrentPage`è¦ç”±å¤–éƒ¨æä¾›ï¼Œæ‰€ä»¥æ¯ä¸ªç­›é€‰é¡¹ç”Ÿæ•ˆéƒ½éœ€è¦é¢å¤–è°ƒç”¨`setCurrentPage`ï¼Œæ‰€ä»¥æˆ‘ä¸ºæ¯ä¸ªç­›é€‰é¡¹éƒ½å†™äº†ä¸€ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚ï¼ˆ`src\mathBlog\BlogList.jsx`ï¼‰ï¼š

```js
const [ctimeRange, setCtimeRange] = useState({
  from: undefined,
  to: undefined,
});

const onTagChange = (tag) => {
  setTagFilter(tag);
  setCurrentPage(1);
};

const handleCtimeRangeChange = (range) => {
  setCtimeRange(range);
  setCurrentPage(1);
};
```

### ç‰¹æ®Šçš„ç­›é€‰é¡¹ï¼š `ctime, mtime`

æˆ‘ä¸æ»¡è¶³äºåªæ”¯æŒåˆ°ä¸€å¤©çš„æ—¶é—´ç­›é€‰ï¼Œæ‰€ä»¥æŸ¥äº†ä¸‹ï¼Œæ‰¾åˆ°[è¿™ä¸ªç»„ä»¶](https://21st.dev/openstatusHQ/datetime-picker/default)ï¼Œä½†æˆ‘è¦çš„æ˜¯æ—¶é—´èŒƒå›´ç­›é€‰ï¼Œæ‰€ä»¥æˆ‘ç»“åˆè¿™ä¸ªç»„ä»¶å’Œshadcnçš„date-pickerï¼Œé­”æ”¹äº†ä¸€ä¸‹ã€‚ç›¸å…³ä»£ç ï¼š

- [`src\component\ui\datetime-range-picker.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/ui/datetime-range-picker.jsx) ï¼šæˆ‘é­”æ”¹çš„ç»„ä»¶ï¼Œæ”¯æŒæ—¶é—´èŒƒå›´ç­›é€‰ã€‚å› ä¸ºshadcnçš„`Calendar`ç»„ä»¶åªæ”¯æŒä¼ å…¥`mode="range"`å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æŠŠä¸¤ä¸ª`TimePicker`æ”¾åœ¨`Calendar`ä¸‹æ–¹çš„åŒä¸€ä¸ªdivï¼Œå¹¶ä¿è¯å®ƒä»¬çš„æ€»å®½åº¦æ¯”`Calendar`å°ï¼Œåšå‡ºé‚£ç§çœ‹ä¸Šå»åƒæ˜¯ä¸¤ä¸ªç›¸åŒçš„ç”±æ—¥å†+`TimePicker`æ„æˆçš„ç»„ä»¶çš„æ„Ÿè§‰ã€‚
- [`src\component\ui\datetime-picker.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/ui/datetime-picker.jsx) ï¼šåªèƒ½é€‰æ—¶é—´

æœ€åæˆåŠŸè®©ç”¨æ³•è¶³å¤Ÿç®€å•ï¼š

```jsx
const [mtimeRange, setMtimeRange] = useState({
  from: undefined,
  to: undefined,
});

<DatetimeRangePicker
  date={mtimeRange}
  setDate={handleMtimeRangeChange}
/>
```

## ã€å¸¸è§„ã€‘è®¾ç½®å¯¹è¯æ¡†

æˆ‘ä¸€å¼€å§‹åœ¨ 21st.dev ä¸Šçœ‹åˆ°äº†ä¸€ä¸ªæ›´ä¸ºé…·ç‚«çš„[å¸¦åŠ¨ç”»çš„å¯¹è¯æ¡†](https://21st.dev/aceternity/animated-modal/default)ï¼Œæƒ³æ¥å…¥å®ƒã€‚ä½†å‘ç°å®ƒä¸€ç›´æœ‰ä¸€ä¸ªbugï¼Œå°±æ˜¯å®ƒå§‹ç»ˆåœ¨ä¸‹æ‹‰æ¡†çš„ä¸‹æ‹‰èœå•çš„ä¸Šé¢ã€‚æˆ‘å¾ˆé•¿æ—¶é—´æ²¡æ‰¾åˆ°ä¿®å®ƒçš„åŠæ³•ï¼Œé—®LLMï¼Œè°ƒ`z-index`ä¹‹ç±»çš„æ‰‹æ®µéƒ½å¤±è´¥ï¼Œå†³å®šæ”¾å¼ƒï¼Œå›å»ä½¿ç”¨shadcnçš„æ ‡å‡†å¯¹è¯æ¡†ã€‚ä½†æ˜¯æ ‡å‡†å¯¹è¯æ¡†æ²¡æœ‰åŠ¨ç”»ï¼Œæ¯”è¾ƒç”Ÿç¡¬ã€‚æˆ‘åœ¨shadcnçš„å®˜æ–¹æ–‡æ¡£æ‰“å¼€F12æ’æŸ¥å‘ç°ï¼Œå®˜æ–¹æ–‡æ¡£ç”¨çš„æ˜¯Tailwind 3.xï¼Œæ‰€ä»¥å®ƒçš„å¯¹è¯æ¡†æœ‰åŠ¨ç”»ï¼Œè€Œæˆ‘çš„é¡¹ç›®ç”¨çš„æ˜¯4.xï¼Œä¸€äº›ç›¸å…³çš„CSSå˜é‡æ²¡æœ‰å®šä¹‰ï¼Œä¸çŸ¥é“æ˜¯è¢«åºŸå¼ƒäº†è¿˜æ˜¯æ€ä¹ˆæ»´ï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿæ²¡è¯´ï¼Œæ‰€ä»¥æ²¡æœ‰åŠ¨ç”»ã€‚äºæ˜¯Kimi K2å¸®æˆ‘ç”Ÿæˆäº†ä¸€äº›ç›¸å…³å˜é‡ï¼š

```css
/* src\index.css */
@theme inline {
  /* Animation variables polyfill for Tailwind 3.x (shadcn uses) */
  --animate-in: animate-in 0.15s ease-out;
  --animate-out: animate-out 0.15s ease-in;
  /* ... */
}

/* src\styles\animate-polyfill.css */
@keyframes animate-in {
  from {
    opacity: 0;
    transform: scale(0.95);
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}
```

å°†å°±ç”¨ç€å…ˆå§ã€‚

### è®¾ç½®å¯¹è¯æ¡†çš„æ¯ä¸ªè®¾ç½®é¡¹éƒ½éœ€è¦å­˜å‚¨åˆ°`localStorage`

è¿™ä¸ªéœ€æ±‚æˆ‘åœ¨ä½¿ç”¨Reactçš„å¼€æºé¡¹ç›®é‡Œä¹Ÿåšè¿‡ä¸¤ä¸‰æ¬¡äº†ã€‚æˆ‘ç›®å‰è§‰å¾—æœ€è¶æ‰‹çš„è¿˜æ˜¯`zustand`ï¼ŒåŒæ—¶æ”¯æŒçŠ¶æ€ç®¡ç†å’Œå†™å…¥`localStorage`ï¼ŒAPIé€šä¿—æ˜“æ‡‚ï¼ŒLLMä¹Ÿèƒ½è½»æ¾ç”Ÿæˆã€‚

## ã€å¸¸è§„ã€‘ç§»åŠ¨ç«¯é€‚é…

ç§»åŠ¨ç«¯é€‚é…æ˜¯ä¸ªæ²¡å•¥æŠ€æœ¯å«é‡çš„æ‚æ´»ï¼Œä½†æ˜¯çœ‹åˆ°è‡ªå·±çš„ç½‘ç«™åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤ºæ•ˆæœä¸å¥½ï¼Œæƒ³è¦ä¼˜åŒ–å®ƒçš„å¼ºè¿«ç—‡å°±ä¼šå‘ä½œã€‚æˆ‘ä»¬ç°åœ¨æœ‰Tailwind CSSå’ŒLLMï¼Œåšç§»åŠ¨ç«¯é€‚é…ä¼šæ¯”ä»¥å‰å®¹æ˜“ä¸€äº›ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨LLMæ—¶ä»£åšç§»åŠ¨ç«¯é€‚é…æœ‰ä¸¤ç§æ–¹å¼ï¼š

1. åœ¨éœ€æ±‚å¼€å‘æ—¶å°±é¡ºä¾¿è®©LLMç”Ÿæˆç§»åŠ¨ç«¯é€‚é…çš„ä»£ç 
2. åœ¨å¼€å‘çš„ä»£ç ç§¯ç´¯åˆ°ä¸€å®šé‡çº§åï¼Œé›†ä¸­åšç§»åŠ¨ç«¯é€‚é…

å…·ä½“é€‰å“ªä¸ªï¼Œæˆ‘è®¤ä¸ºè¦ä¸€äº‹ä¸€è®®ã€‚å¦‚æœä½ ç”¨çš„æ˜¯AIå¼€å‘å¹³å°ï¼Œæ¯”å¦‚cursorã€Claude Code Cliï¼Œå› ä¸ºLLMæœ‰ä½ é¡¹ç›®çš„ä¸Šä¸‹æ–‡ï¼Œé‚£ä¹ˆæˆ‘è®¤ä¸ºä¸€èˆ¬æ¥è¯´ç¬¬ä¸€ç§æ–¹å¼ä¼šæ›´å¥½ã€‚å¦‚æœä½ ä¸æƒ³ä»˜è´¹ä¸Šç­ï¼Œç”¨çš„ç½‘é¡µå…è´¹ç‰ˆLLMï¼Œæ¯”å¦‚æˆ‘è¿™ä¸ªé¡¹ç›®ï¼Œé‚£ä¹ˆæˆ‘è®¤ä¸ºç¬¬äºŒç§æ–¹å¼æ›´å¯èƒ½æ›´å¥½ã€‚

æœ€å¸¸è§„çš„ç§»åŠ¨ç«¯é€‚é…å°±æ˜¯å†™media queryï¼ˆä¸‹é¢ä»£ç æ¥è‡ª`src\component\teachingPlan\basic.module.scss`ï¼‰ï¼š

```css
.container {
  padding: 24px;
  /* ... */
  gap: 24px;
}

@media (min-width: 48rem) {
  .container {
    padding: 30px;
    gap: 30px;
  }
}

@media (min-width: 64rem) {
  .container {
    padding: 30px 100px;
  }
}
```

æˆ‘æ¯”è¾ƒè®¤å¯Tailwindçš„ç†å¿µï¼Œæ‰€ä»¥media queryçš„å†™æ³•åˆ»æ„ä¸Tailwindä¿æŒä¸€è‡´ã€‚ç”¨Tailwind CSSåšç§»åŠ¨ç«¯é€‚é…åˆ™æ›´ç®€å•ã€‚ä»¥ä»¥ä¸‹ä»£ç ä¸ºä¾‹ï¼š`className: 'w-50 sm:w-70 md:w-90'`è¡¨ç¤ºï¼Œåœ¨æœ€å°çš„å±å¹•é‡Œå®½åº¦æ˜¯200pxï¼Œå¤§äºç­‰äº640pxå®½åº¦æ˜¯280pxï¼Œå¤§äºç­‰äº768pxå®½åº¦æ˜¯360pxã€‚å¯ä»¥çœ‹åˆ°ï¼ŒTailwindæ˜¯ç§»åŠ¨ç«¯ä¼˜å…ˆçš„ï¼Œé»˜è®¤æ ·å¼ä½œç”¨äºå±å¹•æœ€å°çš„ç§»åŠ¨ç«¯ã€‚

### å¯¼èˆªæ å˜æ±‰å ¡èœå•

æ•ˆæœï¼š

![6-ç§»åŠ¨ç«¯é€‚é…-å¯¼èˆªæ .png](./README_assets/6-ç§»åŠ¨ç«¯é€‚é…-å¯¼èˆªæ .png)

[å®Œæ•´ä»£ç ä¼ é€é—¨ï¼š`src\component\layout\Navbar.jsx`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/component/layout/Navbar.jsx)

ä¹Ÿæœ‰å°‘æ•°çš„ç§»åŠ¨ç«¯é€‚é…å·¥ä½œä¸æ­¢è°ƒå­—ä½“ã€ç»„ä»¶å¤§å°é‚£ä¹ˆç®€å•ï¼Œæ¯”å¦‚è¿™ä¸ªå¯¼èˆªæ ã€‚åœ¨å°å±å¹•ä¸‹ï¼Œå¯¼èˆªæ ä¸èƒ½å¹³é“ºå±•ç¤ºã€‚äºæ˜¯æˆ‘å†³å®šåœ¨å°å±å¹•ä¸‹å±•ç¤ºä¸€ä¸ªæ±‰å ¡èœå•ã€‚ç›¸å…³ä»£ç ï¼š

```jsx
const [isMenuOpen, setIsMenuOpen] = useState(false);

const toggleMenu = () => {
  setIsMenuOpen(!isMenuOpen);
};

// è§¦å‘æ±‰å ¡èœå•çš„æŒ‰é’®
<button
  className="md:hidden ..."
  onClick={toggleMenu}
  aria-label="èœå•"
  title="èœå•"
>
  {isMenuOpen ? <FaTimes /> : <FaBars />}
</button>

// åŸæœ‰çš„PCç«¯å¯¼èˆªæ 
<div className="hidden md:flex ..." />

// å°å±å¹•ä¸‹çš„æ±‰å ¡èœå•
{isMenuOpen && (
  <motion.div
    className="flex md:hidden ..."
  />
)}
```

åŸæœ‰çš„PCç«¯å¯¼èˆªæ æ˜¯æœ‰ç‚¹schemaåŒ–çš„ï¼Œæ‰€ä»¥ç§»åŠ¨ç«¯çš„å¯¼èˆªæ ä¹Ÿè¦å¤ç”¨å·²æœ‰çš„æ•°æ®ç»“æ„ï¼Œä»£ç å¤§è‡´å¦‚ä¸‹ï¼š

```js
const navigationItems = [promptDisplayDropdown, blogDropdown, aboutThisProjectDropdown, aboutUsDropdown].map((dropdown) => {
  return {
    label: dropdown.children,
    items: dropdown.urls,
    ...dropdown,
  };
});
```

## ã€å¸¸è§„ã€‘éƒ¨ç½²åˆ° GitHub Pages

GitHub Pagesä¸æ˜¯éƒ¨ç½²åˆ°æ ¹è·¯å¾„çš„ï¼Œè€Œæ˜¯éƒ¨ç½²åˆ°ä½ çš„ä»“åº“åçš„ã€‚ä»¥æˆ‘çš„é¡¹ç›®ä¸ºä¾‹ï¼Œæˆ‘é¡¹ç›®çš„è®¿é—®URLå°†æ˜¯ï¼š`https://hans774882968.github.io/teaching-plan-analytic-geometry`ã€‚æ‰€ä»¥ï¼š

1. viteé¡¹ç›®éœ€è¦ä¿®æ”¹`base`ä¸º`/teaching-plan-analytic-geometry/`ã€‚
2. é¡¹ç›®ç”¨åˆ°äº†`react-router-dom`ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼ å…¥`basename`ä¸º`/teaching-plan-analytic-geometry/`ã€‚
3. GeoGebraçš„codebaseä¹Ÿéœ€è¦ç›¸åº”åœ°æ›´æ”¹ã€‚

æˆ‘å¸Œæœ›å¯éšæ—¶é€šè¿‡ç¯å¢ƒå˜é‡åˆ‡æ¢æ˜¯éƒ¨ç½²åˆ°æ ¹è·¯å¾„ï¼Œè¿˜æ˜¯éƒ¨ç½²åˆ°ä»“åº“åã€‚å¹¶ä¸”å¸Œæœ›ä»£ç å®¹æ˜“æµ‹è¯•ï¼Œæ‰€ä»¥æŠ½è±¡äº†ä¸€ä¸ªå…¬å…±æ–‡ä»¶[`src\lib\getWebsiteBasePath.js`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/src/lib/getWebsiteBasePath.js)ã€‚

```js
const GITHUB_PAGE_BASE = '/teaching-plan-analytic-geometry/';

export function getWebsiteBasePath() {
  const isGitHubPages = import.meta.env.VITE_DEPLOY_TARGET === 'github-pages';
  const basePath = isGitHubPages ? GITHUB_PAGE_BASE : '/';
  return basePath;
}

export function getGeogebraHTML5Codebase() {
  const isGitHubPages = import.meta.env.VITE_DEPLOY_TARGET === 'github-pages';
  const codebase = isGitHubPages ? `${GITHUB_PAGE_BASE}geogebra/web3d/` : '/geogebra/web3d/';
  return codebase;
}
```



### `vite.config.js`ä¿®æ”¹`base`

```js
export default defineConfig(() => {
  const basePath = getWebsiteBasePath();

  console.log(`[tpm] Base path: ${basePath}`);

  return {
    base: basePath,
  };
});
```

### `react-router-dom`ä¼ å…¥`basename`

```js
import { BrowserRouter as Router, Routes, Route } from 'react-router-dom';
const basePath = getWebsiteBasePath();
<Router basename={basePath} />
```

### ä¿®æ”¹GeoGebraçš„codebase

`src\component\Geogebra.jsx`ï¼š

```js
const ggbApp = new window.GGBApplet(parameter, true);
ggbApp.setHTML5Codebase(ggbHTML5Codebase);
```

æˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹ä¸Šæ–‡æåˆ°çš„`k = e('...')`è¿™å¥è¯ã€‚ä½†è¿™å¥è¯åœ¨é™æ€èµ„æºä¸­ï¼Œæ— æ³•ç›´æ¥æ‹¿åˆ°ç¯å¢ƒå˜é‡ã€‚æ‰€ä»¥æˆ‘é‡‡ç”¨æœ€ç®€å•ç²—æš´çš„åšæ³•ï¼šç”¨å…¨å±€å˜é‡é€šä¿¡ã€‚é¦–å…ˆåœ¨`src\main.jsx`å†™å…¥ç¯å¢ƒå˜é‡ï¼š

```js
window.GGB_WEB3D_NO_CACHE_BASE_PATH = getGeogebraHTML5Codebase();

// src\lib\getWebsiteBasePath.js
export function getGeogebraHTML5Codebase() {
  const isGitHubPages = import.meta.env.VITE_DEPLOY_TARGET === 'github-pages';
  const codebase = isGitHubPages ? `${GITHUB_PAGE_BASE}geogebra/web3d/` : '/geogebra/web3d/';
  return codebase;
}
```

ç„¶ååœ¨`web3d.nocache.js`ä¸­å¼•ç”¨ï¼š

```js
k = e(window.GGB_WEB3D_NO_CACHE_BASE_PATH);
```

### è°ƒè¯•è¸©å‘ï¼šç¯å¢ƒå˜é‡é—®é¢˜

åšå®Œä¸Šé¢3æ­¥ä»¥åï¼Œè¿™ä¸ªé¡¹ç›®çš„å¼€å‘é˜¶æ®µå’Œæ‰“åŒ…äº§ç‰©åº”è¯¥éƒ½æ˜¯OKçš„ï¼Œ`bun preview`ä¹Ÿèƒ½æ­£å¸¸æ‰§è¡Œã€‚å¦‚æœè¸©å‘ï¼Œé‚£å°±æ˜¯å› ä¸ºç¯å¢ƒå˜é‡æ²¡æœ‰é…ç½®å¥½ã€‚

æ¥ä¸‹æ¥é…ç½®[`.github\workflows\main.yml`](https://github.com/Hans774882968/teaching-plan-analytic-geometry/blob/main/.github/workflows/main.yml)ï¼š

```yaml
name: Deploy to GitHub Pages
on:
  push:
    branches:
      - main
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: 20

    - name: Setup Bun
      run: npm install -g bun

    - name: Checkout
      uses: actions/checkout@v4

    - name: Fetch geogebra assets
      run: |
        git clone https://github.com/Hans774882968/geogebra-resource.git temp_geogebra
        mkdir -p public/geogebra
        cp -r temp_geogebra/* public/geogebra/
        rm -rf temp_geogebra

    - name: Install dependencies
      run:
        bun install

    - name: Build Project
      run: |
        bun run build
      env:
        # TODO: ä¸çŸ¥é“ä¸ºä»€ä¹ˆé…ç½®äº† GitHub Pages çš„ environment  variables ä»¥åï¼Œè¿™é‡Œè¿˜æ˜¯æ‹¿ä¸åˆ°ã€‚æš‚ä¸”è¿™ä¹ˆå†™ç€å…œåº•
        VITE_DEPLOY_TARGET: ${{ vars.VITE_DEPLOY_TARGET || 'github-pages' }}

    - name: Deploy
      uses: peaceiris/actions-gh-pages@v4
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./dist
        commit_message: "Deploy tpm - ${{ github.event.head_commit.message }}"
```

çŸ¥è¯†ç‚¹ï¼š

1. `name`å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ­¥éª¤ã€‚åœ¨è¿™é‡Œå†™æˆ‘ä»¬çš„`bun run build`ä¹‹ç±»çš„å‘½ä»¤ã€‚
2. `jobs`ä¸‹ä¸€ä¸ªjobçš„åå­—å¯ä»¥ä»»å–ï¼Œä½†ä¸€èˆ¬æ˜¯å«`build`æˆ–`build-and-deploy`ã€‚
3. ä¸ºäº†å°†`public\geogebra`å¤åˆ¶åˆ°éƒ¨ç½²æœåŠ¡å™¨çš„å¯¹åº”æ–‡ä»¶å¤¹ä¸‹ï¼Œæˆ‘é‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šæ–°å»ºä¸€ä¸ªç‹¬ç«‹çš„ä»“åº“ï¼Œç„¶ååœ¨éƒ¨ç½²é˜¶æ®µæ‰‹åŠ¨å¤åˆ¶è¿‡å»ã€‚ç›¸å…³å‘½ä»¤ï¼š

```bash
git clone https://github.com/Hans774882968/geogebra-resource.git temp_geogebra
mkdir -p public/geogebra
cp -r temp_geogebra/* public/geogebra/
rm -rf temp_geogebra
```

æœ€åæ ¹æ®[å‚è€ƒé“¾æ¥3](https://blog.csdn.net/qq_20042935/article/details/133920722)ï¼Œè®¾ç½®ä¸€ä¸‹å¼€æºé¡¹ç›®çš„GitHub Pageså’ŒEnvironments tabé‡Œçš„environment  variablesã€‚åˆ·æ–°ä¸€ä¸‹å°±OK~

### GitHub Pagesç›´æ¥é€šè¿‡é“¾æ¥è®¿é—®åªèƒ½æ‹¿åˆ°404çš„é—®é¢˜ï¼šåšä¸€ä¸ª`404.html`

é—®LLMæˆ–è€…æŸ¥æœç´¢å¼•æ“ä¸éš¾å¾—çŸ¥ï¼ŒGitHub Pagesæ²¡æœ‰èƒ½åŠ›æ”¯æŒ`react-router-dom`ã€‚è¦ä¹ˆæ”¹ç”¨å“ˆå¸Œè·¯ç”±ï¼Œè¦ä¹ˆåšä¸€ä¸ª`404.html`ä½œä¸ºè·³æ¿ï¼Œå…ˆè½¬åˆ°é¦–é¡µæˆ–å…¶ä»–æ”¯æŒ`react-router-dom`çš„é¡µé¢ï¼Œå†è½¬åˆ°ç›®æ ‡é¡µé¢ã€‚æˆ‘ä¸æƒ³æ¢æˆå“ˆå¸Œè·¯ç”±ï¼Œå› æ­¤éœ€è¦åšä¸€ä¸ª`404.html`ã€‚æ­¥éª¤ï¼š

1. åœ¨`404.html`å†™JSï¼Œè½¬åˆ°é¦–é¡µï¼Œå¹¶å¸¦ä¸Šä¸€ä¸ªqueryå‚æ•°ï¼Œè®©é¦–é¡µèƒ½å¤Ÿæ‹¿åˆ°ç›®æ ‡ç½‘å€
2. é¦–é¡µæ‹¿åˆ°ç›®æ ‡ä½ç½®ï¼Œåˆ‡è¿‡å»

`404.html`å¯ä»¥ç”¨æˆ‘ä¹‹å‰å†™å¥½çš„`NotFound.jsx`æ”¹æ”¹æ‹¿åˆ°ï¼Œä½†æˆ‘è¿è¿™ä¸ªæ”¹åŠ¨å·¥ä½œéƒ½ä¸æƒ³åšäº†ï¼Œç›´æ¥äº¤ç»™DeepSeekï¼š

```markdown
å¤§ä½¬ï¼Œä½ æ˜¯ä¸€åä¸“å®¶å‰ç«¯å·¥ç¨‹å¸ˆï¼Œç²¾é€šå‰ç«¯å·¥ç¨‹åŒ–ã€‚è¯·å«æˆ‘hans7ã€‚æˆ‘æœ‰ä¸€ä¸ªVIte + React + Tailwind CSS + framer-motioné¡¹ç›®ï¼Œå®ƒçš„404é¡µé¢ç»„ä»¶ä»£ç å¦‚ä¸‹ï¼š
src\NotFound.jsxï¼š

é…å¥—çš„æ ·å¼ src\NotFound.module.scssï¼š

æˆ‘ç°åœ¨éœ€è¦ä¸€ä¸ª404.htmlã€‚è¯·ç»“åˆè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¸®æˆ‘å®Œæˆè½¬æ¢ã€‚è¦æ±‚å¦‚ä¸‹ï¼š

1. è¯·è¾“å‡ºä¸€ä¸ªæ²¡æœ‰ä»»ä½•CDNä¾èµ–çš„çº¯HTMLæ–‡ä»¶ï¼Œä»…åŒ…å«CSSå’ŒHTMLã€‚
2. cnå‡½æ•°ç”¨äºæ‹¼æ¥ç±»åã€‚è¯·å°†æ‰€æœ‰çš„Tailwind CSSç±»åè½¬ä¸ºçº¯CSSã€‚
3. react-router-domçš„Linkæ ‡ç­¾è½¬åŒ–ä¸ºaæ ‡ç­¾ã€‚
4. framer-motionç›¸å…³çš„ä»£ç è½¬åŒ–ä¸ºCSSä»£ç ã€‚
```

å®ƒå®Œæˆçš„è´¨é‡å¾ˆé«˜ï¼Œæˆ‘åŸºæœ¬ä¸Šæ²¡åšä»»ä½•ä¿®æ”¹å°±ç›´æ¥ç”¨èµ·æ¥äº†ã€‚`404.html`ä»…æœ‰çš„JSå¦‚ä¸‹ï¼š

```js
document.getElementById('currentYear').textContent = new Date().getFullYear();

const basePath = '/teaching-plan-analytic-geometry/';
const currentPath = window.location.pathname.replace(basePath, '');
document.getElementById('target-path').textContent = currentPath;
// é‡å®šå‘åˆ° SPA
window.location.href = `${basePath}?redirect=${encodeURIComponent(currentPath)}`;
```

é¦–é¡µå¸®å¿™é€åˆ°ç›®æ ‡ä½ç½®çš„ä»£ç `src\NavigateForGitHubPages.jsx`ï¼š

```jsx
import { useEffect } from 'react';
import { useLocation, useNavigate } from 'react-router-dom';

export default function NavigateForGitHubPages({ children }) {
  const navigate = useNavigate();
  const location = useLocation();

  useEffect(() => {
    // å¤„ç†ä» GitHub Pages çš„ 404 é¡µé¢é‡å®šå‘è¿‡æ¥çš„è¯·æ±‚
    const urlParams = new URLSearchParams(location.search);
    const redirectPath = urlParams.get('redirect');

    if (redirectPath) {
      // ç§»é™¤é‡å®šå‘å‚æ•°
      const cleanPath = window.location.pathname + window.location.search.replace(/\?redirect=.*/, '');
      window.history.replaceState(null, '', cleanPath);

      // å¯¼èˆªåˆ°ç›®æ ‡è·¯å¾„
      navigate(redirectPath);
    }
  }, [location, navigate]);

  return children;
}
```

ä½¿ç”¨ï¼š

```jsx
<NavigateForGitHubPages>
  <ThemeProvider defaultTheme="light">
    ...
  </ThemeProvider>
</NavigateForGitHubPages>
```



## å‚è€ƒèµ„æ–™

1. GeoGebraå®˜æ–¹æ–‡æ¡£ï¼š https://geogebra.github.io/docs/reference/en/GeoGebra_Apps_Embedding/
2. å¦‚ä½•åœ¨VSCodeä¸­è°ƒè¯•vitestï¼š https://cn.vitest.dev/guide/debugging
3. ä¿å§†çº§æ•™ç¨‹ï¼šä»é›¶æ„å»ºGitHub Pagesé™æ€ç½‘ç«™ï¼š https://blog.csdn.net/qq_20042935/article/details/133920722

